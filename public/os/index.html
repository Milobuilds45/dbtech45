<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DB TECH OS — Command Center</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect rx='20' width='100' height='100' fill='%23F59E0B'/><text x='50' y='62' font-size='42' font-weight='bold' text-anchor='middle' fill='white' font-family='sans-serif'>DB</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* ═══════════════════════════════════════════
           DB TECH OS — Design System v2.0
           Premium Command Center
           ═══════════════════════════════════════════ */

        :root {
            /* Core Palette — Electric Amber Brand */
            --bg-primary: #0F0F0F;
            --bg-secondary: #1A1A1A;
            --bg-card: rgba(26, 26, 26, 0.7);
            --bg-card-solid: #1A1A1A;
            --bg-card-hover: rgba(42, 42, 42, 0.8);
            --bg-elevated: #2A2A2A;
            --bg-input: #1A1A1A;
            --bg-glass: rgba(15, 15, 15, 0.6);

            /* Borders */
            --border: rgba(51, 51, 51, 0.6);
            --border-hover: rgba(51, 51, 51, 1);
            --border-active: rgba(245, 158, 11, 0.4);
            --border-gradient: linear-gradient(135deg, #F59E0B, #D97706, #FBBF24, #F59E0B);

            /* Text */
            --text-primary: #FFFFFF;
            --text-secondary: #A1A1A1;
            --text-tertiary: #6B6B6B;
            --text-inverse: #0F0F0F;

            /* Accent — Electric Amber */
            --accent: #F59E0B;
            --accent-secondary: #D97706;
            --accent-tertiary: #FBBF24;
            --accent-hover: #FBBF24;
            --accent-muted: rgba(245, 158, 11, 0.1);
            --accent-glow: rgba(245, 158, 11, 0.25);
            --gradient-accent: linear-gradient(135deg, #F59E0B, #D97706);
            --gradient-accent-vivid: linear-gradient(135deg, #FBBF24, #F59E0B, #D97706);

            /* Status Colors */
            --status-online: #10B981;
            --status-busy: #F59E0B;
            --status-offline: #64748b;
            --status-active: #10B981;
            --status-progress: #D97706;
            --status-launched: #F59E0B;
            --status-paused: #FBBF24;
            --status-shipped: #10B981;
            --status-building: #F59E0B;
            --status-beta: #8B5CF6;
            --status-planning: #3B82F6;
            --status-shaping: #06B6D4;
            --status-spark: #EC4899;
            --status-killed: #EF4444;

            /* Semantic */
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
            --info: #3B82F6;

            /* Project Colors */
            --color-soul-solace: #a78bfa;
            --color-signal-noise: #f472b6;
            --color-boundless: #34d399;
            --color-sunday-squares: #fb923c;
            --color-tickr: #22d3ee;
            --color-concrete: #94a3b8;
            --color-sharpedge: #f87171;
            --color-dbtech45: #fbbf24;

            /* Spacing */
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 20px;
            --space-6: 24px;
            --space-8: 32px;
            --space-10: 40px;
            --space-12: 48px;
            --space-16: 64px;

            /* Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;

            /* Shadows */
            --shadow-card: 0 1px 3px rgba(0,0,0,0.4), 0 0 0 1px var(--border);
            --shadow-elevated: 0 8px 32px rgba(0,0,0,0.5), 0 0 0 1px var(--border);
            --shadow-glow: 0 0 40px var(--accent-glow);
            --shadow-glow-sm: 0 0 20px rgba(245, 158, 11, 0.15);

            /* Transitions */
            --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 250ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 400ms cubic-bezier(0.4, 0, 0.2, 1);
            --transition-spring: 500ms cubic-bezier(0.34, 1.56, 0.64, 1);

            /* Glass */
            --glass-blur: blur(20px);
            --glass-bg: rgba(15, 15, 15, 0.6);
        }

        /* ═══ LIGHT THEME ═══ */
        [data-theme="light"] {
            --bg-primary: #FAFAFA;
            --bg-secondary: #ffffff;
            --bg-card: rgba(255, 255, 255, 0.8);
            --bg-card-solid: #ffffff;
            --bg-card-hover: rgba(245, 245, 245, 0.9);
            --bg-elevated: #ffffff;
            --bg-input: #F5F5F5;
            --bg-glass: rgba(255, 255, 255, 0.7);
            --border: rgba(0, 0, 0, 0.08);
            --border-hover: rgba(0, 0, 0, 0.15);
            --border-active: rgba(245, 158, 11, 0.4);
            --text-primary: #0F0F0F;
            --text-secondary: #6B6B6B;
            --text-tertiary: #A1A1A1;
            --text-inverse: #ffffff;
            --accent-muted: rgba(245, 158, 11, 0.08);
            --accent-glow: rgba(245, 158, 11, 0.15);
            --glass-bg: rgba(255, 255, 255, 0.7);
            --shadow-card: 0 1px 3px rgba(0,0,0,0.06), 0 0 0 1px var(--border);
            --shadow-elevated: 0 8px 32px rgba(0,0,0,0.08), 0 0 0 1px var(--border);
        }

        /* ═══════════════════════════════════════════
           RESET & BASE
           ═══════════════════════════════════════════ */

        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.5;
            min-height: 100vh;
            overflow-x: hidden;
        }

        h1, h2, h3, h4, h5, h6 {
            font-family: 'Space Grotesk', 'Inter', sans-serif;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; height: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.15); }
        [data-theme="light"] ::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.1); }
        [data-theme="light"] ::-webkit-scrollbar-thumb:hover { background: rgba(0,0,0,0.2); }

        /* ═══════════════════════════════════════════
           AMBIENT BACKGROUND
           ═══════════════════════════════════════════ */

        .ambient-bg {
            position: fixed;
            inset: 0;
            z-index: 0;
            overflow: hidden;
            pointer-events: none;
        }

        .ambient-bg::before {
            content: '';
            position: absolute;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(245, 158, 11, 0.06) 0%, transparent 70%);
            top: -200px;
            right: -100px;
            animation: ambientFloat1 20s ease-in-out infinite;
        }

        .ambient-bg::after {
            content: '';
            position: absolute;
            width: 500px;
            height: 500px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(217, 119, 6, 0.05) 0%, transparent 70%);
            bottom: -150px;
            left: 10%;
            animation: ambientFloat2 25s ease-in-out infinite;
        }

        .ambient-orb {
            position: absolute;
            width: 400px;
            height: 400px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(251, 191, 36, 0.04) 0%, transparent 70%);
            top: 40%;
            left: 40%;
            animation: ambientFloat3 30s ease-in-out infinite;
        }

        [data-theme="light"] .ambient-bg::before { background: radial-gradient(circle, rgba(245, 158, 11, 0.04) 0%, transparent 70%); }
        [data-theme="light"] .ambient-bg::after { background: radial-gradient(circle, rgba(217, 119, 6, 0.03) 0%, transparent 70%); }
        [data-theme="light"] .ambient-orb { background: radial-gradient(circle, rgba(251, 191, 36, 0.03) 0%, transparent 70%); }

        @keyframes ambientFloat1 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(-50px, 80px) scale(1.1); }
            66% { transform: translate(30px, -40px) scale(0.95); }
        }

        @keyframes ambientFloat2 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(60px, -50px) scale(1.05); }
            66% { transform: translate(-30px, 30px) scale(1.1); }
        }

        @keyframes ambientFloat3 {
            0%, 100% { transform: translate(0, 0) scale(1); }
            50% { transform: translate(-40px, 60px) scale(1.15); }
        }

        /* ═══════════════════════════════════════════
           LAYOUT
           ═══════════════════════════════════════════ */

        .app {
            display: flex;
            min-height: 100vh;
            position: relative;
            z-index: 1;
        }

        /* ═══ SIDEBAR ═══ */
        .sidebar {
            width: 260px;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border-right: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            z-index: 100;
            transition: transform var(--transition-base);
        }

        .sidebar-header {
            padding: var(--space-6);
            border-bottom: 1px solid var(--border);
        }

        .os-logo {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .os-logo-icon {
            width: 40px;
            height: 40px;
            background: var(--gradient-accent);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 13px;
            color: white;
            letter-spacing: -0.5px;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-glow-sm);
        }

        .os-logo-icon::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.25) 0%, transparent 50%);
        }

        .os-logo-text {
            display: flex;
            flex-direction: column;
        }

        .os-logo-text .title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 16px;
            font-weight: 700;
            letter-spacing: -0.3px;
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .os-logo-text .subtitle {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .sidebar-nav {
            flex: 1;
            padding: var(--space-4) var(--space-3);
            overflow-y: auto;
        }

        .nav-section {
            margin-bottom: var(--space-6);
        }

        .nav-section-label {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-tertiary);
            padding: 0 var(--space-3);
            margin-bottom: var(--space-2);
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-3);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
            position: relative;
            user-select: none;
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.04);
            color: var(--text-primary);
        }

        .nav-item.active {
            background: var(--accent-muted);
            color: var(--accent);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 3px;
            height: 16px;
            background: var(--gradient-accent);
            border-radius: 0 2px 2px 0;
        }

        .nav-kbd {
            margin-left: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 9px;
            color: var(--text-tertiary);
            opacity: 0.5;
        }

        .nav-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .nav-badge {
            margin-left: auto;
            background: var(--gradient-accent);
            color: white;
            font-size: 10px;
            font-weight: 600;
            padding: 1px 7px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .sidebar-footer {
            padding: var(--space-4) var(--space-6);
            border-top: 1px solid var(--border);
        }

        .sidebar-greeting {
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: var(--space-1);
        }

        .sidebar-greeting strong {
            color: var(--text-primary);
        }

        .sidebar-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .sidebar-status {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            margin-top: var(--space-2);
            font-size: 11px;
            color: var(--status-online);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.4; }
        }

        /* ═══ MAIN ═══ */
        .main {
            flex: 1;
            margin-left: 260px;
            min-height: 100vh;
        }

        /* ═══ TOPBAR ═══ */
        .topbar {
            position: sticky;
            top: 0;
            z-index: 50;
            background: var(--glass-bg);
            backdrop-filter: var(--glass-blur);
            -webkit-backdrop-filter: var(--glass-blur);
            border-bottom: 1px solid var(--border);
            padding: 0 var(--space-8);
            height: 56px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .topbar-left {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 20px;
            padding: var(--space-2);
        }

        .topbar-greeting {
            font-size: 14px;
            color: var(--text-secondary);
        }

        .topbar-greeting strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .topbar-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 15px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .topbar-breadcrumb {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        .topbar-right {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .topbar-clock {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--text-tertiary);
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-sm);
            background: rgba(255,255,255,0.03);
            border: 1px solid var(--border);
        }

        .theme-toggle {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: rgba(255,255,255,0.03);
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            transition: all var(--transition-fast);
        }

        .theme-toggle:hover {
            background: var(--accent-muted);
            border-color: var(--accent);
            color: var(--accent);
        }

        .topbar-search {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: var(--space-2) var(--space-3);
            width: 220px;
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .topbar-search:hover {
            border-color: var(--border-hover);
        }

        .topbar-search:focus-within {
            border-color: var(--border-active);
            box-shadow: 0 0 0 3px var(--accent-muted);
        }

        .topbar-search input {
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 12px;
            font-family: inherit;
            width: 100%;
            outline: none;
            cursor: pointer;
        }

        .topbar-search input::placeholder {
            color: var(--text-tertiary);
        }

        .topbar-search .search-icon {
            color: var(--text-tertiary);
            font-size: 13px;
        }

        .topbar-kbd {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--text-tertiary);
            background: rgba(255,255,255,0.04);
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        /* ═══ CONTENT ═══ */
        .content {
            padding: var(--space-8);
            max-width: 1400px;
            margin: 0 auto;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: sectionIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes sectionIn {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-6);
        }

        .section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 24px;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .section-subtitle {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: var(--space-1);
        }

        /* ═══════════════════════════════════════════
           COMPONENTS — GLASS CARDS
           ═══════════════════════════════════════════ */

        .card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-base);
            position: relative;
        }

        .card:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
        }

        /* Animated gradient border on hover */
        .card-glow {
            position: relative;
        }

        .card-glow::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: inherit;
            padding: 1px;
            background: var(--border-gradient);
            background-size: 300% 300%;
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity var(--transition-base);
            animation: gradientRotate 4s linear infinite;
        }

        .card-glow:hover::before {
            opacity: 1;
        }

        @keyframes gradientRotate {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* ═══ BUTTONS ═══ */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-sm);
            font-size: 12px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all var(--transition-fast);
            border: 1px solid var(--border);
            background: var(--bg-card-solid);
            color: var(--text-secondary);
            user-select: none;
        }

        .btn:hover {
            background: var(--bg-card-hover);
            color: var(--text-primary);
            border-color: var(--border-hover);
        }

        .btn:active {
            transform: scale(0.96);
        }

        .btn-primary {
            background: var(--gradient-accent);
            color: white;
            border-color: transparent;
            box-shadow: var(--shadow-glow-sm);
        }

        .btn-primary:hover {
            filter: brightness(1.1);
            color: white;
            border-color: transparent;
        }

        .btn-sm {
            padding: var(--space-1) var(--space-3);
            font-size: 11px;
        }

        /* ═══ BADGES ═══ */
        .badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .badge-online { background: rgba(34, 197, 94, 0.12); color: var(--status-online); }
        .badge-busy { background: rgba(245, 158, 11, 0.12); color: var(--status-busy); }
        .badge-offline { background: rgba(100, 116, 139, 0.12); color: var(--status-offline); }
        .badge-active { background: rgba(34, 197, 94, 0.12); color: var(--status-active); }
        .badge-progress { background: rgba(217, 119, 6, 0.12); color: var(--status-progress); }
        .badge-launched { background: rgba(6, 182, 212, 0.12); color: var(--status-launched); }
        .badge-paused { background: rgba(245, 158, 11, 0.12); color: var(--status-paused); }
        .badge-shipped { background: rgba(16, 185, 129, 0.12); color: var(--status-shipped); }
        .badge-building { background: rgba(245, 158, 11, 0.12); color: var(--status-building); }
        .badge-beta { background: rgba(139, 92, 246, 0.12); color: var(--status-beta); }
        .badge-planning { background: rgba(59, 130, 246, 0.12); color: var(--status-planning); }
        .badge-shaping { background: rgba(6, 182, 212, 0.12); color: var(--status-shaping); }
        .badge-spark { background: rgba(236, 72, 153, 0.12); color: var(--status-spark); }
        .badge-killed { background: rgba(239, 68, 68, 0.12); color: var(--status-killed); }

        .badge-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        /* ═══════════════════════════════════════════
           SKELETON LOADING
           ═══════════════════════════════════════════ */

        .skeleton {
            background: linear-gradient(90deg,
                rgba(255,255,255,0.03) 25%,
                rgba(255,255,255,0.06) 50%,
                rgba(255,255,255,0.03) 75%
            );
            background-size: 200% 100%;
            animation: skeletonShimmer 1.5s ease-in-out infinite;
            border-radius: var(--radius-sm);
        }

        [data-theme="light"] .skeleton {
            background: linear-gradient(90deg,
                rgba(0,0,0,0.04) 25%,
                rgba(0,0,0,0.08) 50%,
                rgba(0,0,0,0.04) 75%
            );
            background-size: 200% 100%;
        }

        @keyframes skeletonShimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .skeleton-text { height: 14px; width: 70%; }
        .skeleton-title { height: 20px; width: 40%; margin-bottom: 8px; }
        .skeleton-card { height: 160px; }

        /* ═══════════════════════════════════════════
           TOAST NOTIFICATIONS
           ═══════════════════════════════════════════ */

        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 500;
            display: flex;
            flex-direction: column-reverse;
            gap: 8px;
            pointer-events: none;
        }

        .toast {
            background: var(--bg-elevated);
            backdrop-filter: var(--glass-blur);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: var(--space-4) var(--space-5);
            box-shadow: var(--shadow-elevated);
            animation: toastIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: auto;
            max-width: 360px;
            display: flex;
            align-items: flex-start;
            gap: var(--space-3);
        }

        .toast.removing {
            animation: toastOut 0.3s ease forwards;
        }

        .toast-icon {
            font-size: 16px;
            flex-shrink: 0;
            margin-top: 1px;
        }

        .toast-body {
            flex: 1;
        }

        .toast-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .toast-message {
            font-size: 12px;
            color: var(--text-secondary);
            margin-top: 2px;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            font-size: 14px;
            padding: 0;
            flex-shrink: 0;
        }

        .toast-accent {
            border-left: 3px solid var(--accent);
        }

        .toast-success {
            border-left: 3px solid var(--success);
        }

        .toast-warning {
            border-left: 3px solid var(--warning);
        }

        @keyframes toastIn {
            from { opacity: 0; transform: translateX(40px) scale(0.95); }
            to { opacity: 1; transform: translateX(0) scale(1); }
        }

        @keyframes toastOut {
            to { opacity: 0; transform: translateX(40px) scale(0.95); }
        }

        /* ═══════════════════════════════════════════
           MISSION CONTROL
           ═══════════════════════════════════════════ */

        .stats-row {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-4);
            margin-bottom: var(--space-8);
        }

        .stat-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            position: relative;
            overflow: hidden;
            transition: all var(--transition-base);
        }

        .stat-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-2px);
        }

        .stat-card::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--gradient-accent);
            opacity: 0;
            transition: opacity var(--transition-base);
        }

        .stat-card:hover::after {
            opacity: 1;
        }

        .stat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .stat-label {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .stat-sparkline {
            width: 48px;
            height: 20px;
            opacity: 0.5;
        }

        .stat-sparkline path {
            fill: none;
            stroke: var(--accent);
            stroke-width: 1.5;
            stroke-linecap: round;
        }

        .stat-sparkline .sparkline-fill {
            fill: url(#sparkGradient);
            stroke: none;
        }

        .stat-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 32px;
            font-weight: 700;
            letter-spacing: -1px;
            margin-top: var(--space-2);
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-detail {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-top: var(--space-1);
        }

        .agents-section-header {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: var(--space-4);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .agents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(290px, 1fr));
            gap: var(--space-4);
        }

        .agent-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .agent-card::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: inherit;
            padding: 1px;
            background: linear-gradient(135deg, var(--agent-color, var(--accent)), transparent 60%);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity var(--transition-base);
        }

        .agent-card:hover {
            transform: translateY(-3px) scale(1.01);
            box-shadow: var(--shadow-elevated);
        }

        .agent-card:hover::before {
            opacity: 1;
        }

        .agent-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-4);
        }

        .agent-identity {
            display: flex;
            align-items: center;
            gap: var(--space-3);
        }

        .agent-avatar {
            width: 42px;
            height: 42px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 17px;
            font-weight: 700;
            color: white;
            position: relative;
            flex-shrink: 0;
        }

        .agent-avatar .status-indicator {
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 2px solid var(--bg-card-solid);
        }

        .agent-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
        }

        .agent-role {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-top: 1px;
        }

        .agent-body {
            margin-bottom: var(--space-4);
        }

        .agent-task {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: flex-start;
            gap: var(--space-2);
            line-height: 1.6;
        }

        .agent-task-icon {
            color: var(--accent);
            margin-top: 2px;
            flex-shrink: 0;
        }

        .agent-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: var(--space-3);
            padding-top: var(--space-3);
            border-top: 1px solid var(--border);
        }

        .agent-last-active {
            font-size: 10px;
            font-family: 'JetBrains Mono', monospace;
            color: var(--text-tertiary);
        }

        .agent-action {
            background: var(--accent-muted);
            color: var(--accent);
            border: none;
            padding: var(--space-1) var(--space-3);
            border-radius: var(--radius-sm);
            font-size: 11px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .agent-action:hover {
            background: var(--accent);
            color: white;
        }

        .agent-action:active {
            transform: scale(0.95);
        }

        /* ═══════════════════════════════════════════
           PROJECTS
           ═══════════════════════════════════════════ */

        .projects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--space-4);
        }

        .project-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .project-card:hover {
            border-color: var(--border-hover);
            transform: translateY(-3px) scale(1.01);
            box-shadow: var(--shadow-elevated);
        }

        .project-color-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            opacity: 0.8;
        }

        .project-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: var(--space-3);
        }

        .project-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 16px;
            font-weight: 700;
            letter-spacing: -0.3px;
        }

        .project-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: var(--space-4);
        }

        .project-progress {
            margin-bottom: var(--space-4);
        }

        .progress-bar-bg {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.06);
            border-radius: 2px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            border-radius: 2px;
            transition: width 1.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .progress-bar-fill::after {
            content: '';
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 20px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3));
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 10px;
            color: var(--text-tertiary);
            margin-top: var(--space-2);
            font-family: 'JetBrains Mono', monospace;
        }

        .project-links {
            display: flex;
            gap: var(--space-2);
            flex-wrap: wrap;
        }

        .project-link {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 11px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .project-link:hover {
            background: var(--accent-muted);
            border-color: var(--accent);
            color: var(--accent);
        }

        .project-card.killed {
            opacity: 0.5;
        }

        .star-rating {
            display: flex;
            gap: 2px;
            margin: 8px 0;
        }

        .star-rating .star {
            cursor: pointer;
            color: #333;
            font-size: 16px;
            transition: color 0.15s;
            user-select: none;
        }

        .star-rating .star.filled,
        .star-rating .star.hover {
            color: #F59E0B;
        }

        .kanban-btn {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 12px;
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 11px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-family: inherit;
        }

        .kanban-btn:hover {
            background: var(--accent-muted);
            border-color: var(--accent);
            color: var(--accent);
        }

        .kanban-btn.sent {
            background: rgba(16, 185, 129, 0.12);
            border-color: #10B981;
            color: #10B981;
            pointer-events: none;
        }

        .sort-priority-btn {
            padding: var(--space-2) var(--space-4);
            border-radius: 20px;
            font-size: 11px;
            font-weight: 500;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-family: inherit;
        }

        .sort-priority-btn:hover, .sort-priority-btn.active {
            background: var(--accent-muted);
            border-color: var(--accent);
            color: var(--accent);
        }

        /* ═══════════════════════════════════════════
           AXECAP TERMINAL (MARKETS)
           ═══════════════════════════════════════════ */

        .axecap-terminal { background: #0A0A0A; border: 1px solid #222; border-radius: 8px; overflow: hidden; }
        .axecap-header { display: flex; justify-content: space-between; align-items: center; padding: 12px 16px; border-bottom: 1px solid #222; background: #0F0F0F; }
        .axecap-title { font-family: 'Space Grotesk', sans-serif; font-size: 14px; font-weight: 700; color: #F59E0B; letter-spacing: 0.1em; text-transform: uppercase; }
        .axecap-status { display: flex; align-items: center; gap: 6px; font-size: 11px; font-family: 'JetBrains Mono', monospace; color: #888; }
        .axecap-status .dot { width: 6px; height: 6px; border-radius: 50%; animation: axecapBlink 2s ease-in-out infinite; }
        .axecap-status .dot.live { background: #10B981; }
        .axecap-status .dot.sim { background: #F59E0B; }
        .axecap-refresh-btn { background: transparent; border: 1px solid #333; border-radius: 4px; padding: 4px 10px; color: #888; font-family: 'JetBrains Mono', monospace; font-size: 10px; cursor: pointer; transition: all 0.2s; }
        .axecap-refresh-btn:hover { border-color: #F59E0B; color: #F59E0B; }

        .ticker-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 1px; background: #222; }
        .ticker-cell { background: #0F0F0F; padding: 12px; transition: background 0.2s; }
        .ticker-cell:hover { background: #141414; }
        .ticker-symbol { font-family: 'JetBrains Mono', monospace; font-size: 14px; font-weight: 700; color: #F59E0B; }
        .ticker-name { font-size: 10px; color: #666; margin-top: 2px; }
        .ticker-price { font-family: 'JetBrains Mono', monospace; font-size: 20px; font-weight: 700; color: #fff; margin-top: 8px; }
        .ticker-change { font-family: 'JetBrains Mono', monospace; font-size: 12px; margin-top: 4px; }
        .ticker-change.up { color: #10B981; }
        .ticker-change.down { color: #EF4444; }
        .ticker-range { display: flex; justify-content: space-between; margin-top: 6px; font-family: 'JetBrains Mono', monospace; font-size: 9px; color: #444; }
        .ticker-sparkline { margin-top: 6px; height: 20px; display: flex; align-items: flex-end; gap: 1px; }
        .ticker-sparkline .bar { width: 3px; background: #333; border-radius: 1px; transition: height 0.3s; }
        .ticker-sparkline .bar.up { background: #10B981; }
        .ticker-sparkline .bar.down { background: #EF4444; }

        .watchlist-panel { padding: 12px 16px; border-top: 1px solid #222; }
        .watchlist-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .watchlist-label { font-family: 'Space Grotesk', sans-serif; font-size: 12px; font-weight: 700; color: #F59E0B; letter-spacing: 0.08em; text-transform: uppercase; }
        .watchlist-add { display: flex; gap: 8px; }
        .watchlist-input { background: #1A1A1A; border: 1px solid #333; border-radius: 4px; padding: 6px 10px; color: #fff; font-family: 'JetBrains Mono', monospace; font-size: 12px; width: 100px; text-transform: uppercase; outline: none; transition: border-color 0.2s; }
        .watchlist-input:focus { border-color: #F59E0B; }
        .watchlist-input::placeholder { color: #444; text-transform: none; }
        .watchlist-btn { background: #F59E0B; color: #000; border: none; border-radius: 4px; padding: 6px 12px; font-size: 11px; font-weight: 700; cursor: pointer; transition: background 0.2s; }
        .watchlist-btn:hover { background: #D97706; }
        .watchlist-table { width: 100%; border-collapse: collapse; }
        .watchlist-table th { font-size: 10px; color: #666; text-transform: uppercase; letter-spacing: 0.05em; padding: 6px 8px; text-align: left; border-bottom: 1px solid #222; font-family: 'JetBrains Mono', monospace; }
        .watchlist-table td { font-family: 'JetBrains Mono', monospace; font-size: 12px; padding: 8px; border-bottom: 1px solid #1A1A1A; color: #ccc; }
        .watchlist-table tr:hover td { background: #141414; }
        .watchlist-table td.wl-symbol { color: #F59E0B; font-weight: 700; }
        .watchlist-table td.wl-price { color: #fff; font-weight: 700; }
        .watchlist-remove { cursor: pointer; color: #666; font-size: 14px; background: none; border: none; padding: 2px 6px; transition: color 0.2s; }
        .watchlist-remove:hover { color: #EF4444; }
        .watchlist-empty { color: #444; font-size: 12px; font-family: 'JetBrains Mono', monospace; padding: 12px 0; text-align: center; }

        .news-panel { padding: 12px 16px; border-top: 1px solid #222; max-height: 300px; overflow-y: auto; }
        .news-panel::-webkit-scrollbar { width: 4px; }
        .news-panel::-webkit-scrollbar-track { background: #0A0A0A; }
        .news-panel::-webkit-scrollbar-thumb { background: #333; border-radius: 2px; }
        .news-panel-header { font-family: 'Space Grotesk', sans-serif; font-size: 12px; font-weight: 700; color: #F59E0B; letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 8px; }
        .news-item { padding: 8px 0; border-bottom: 1px solid #1A1A1A; }
        .news-item:last-child { border-bottom: none; }
        .news-meta { display: flex; align-items: center; gap: 8px; }
        .news-time { font-family: 'JetBrains Mono', monospace; font-size: 10px; color: #666; }
        .news-headline { font-size: 13px; color: #ccc; margin-top: 4px; line-height: 1.4; }
        .news-source { font-size: 10px; color: #F59E0B; margin-top: 2px; display: inline; }
        .news-ticker { background: rgba(245, 158, 11, 0.1); color: #F59E0B; padding: 1px 6px; border-radius: 3px; font-size: 10px; font-family: 'JetBrains Mono', monospace; margin-left: 8px; display: inline; }

        .axecap-statusbar { display: flex; justify-content: space-between; align-items: center; padding: 8px 16px; border-top: 1px solid #222; background: #0A0A0A; font-family: 'JetBrains Mono', monospace; font-size: 10px; color: #666; flex-wrap: wrap; gap: 8px; }
        .axecap-statusbar-left { display: flex; align-items: center; gap: 12px; }
        .axecap-statusbar-right { display: flex; align-items: center; gap: 12px; }
        .axecap-statusbar .status-live { color: #10B981; }
        .axecap-statusbar .status-sim { color: #F59E0B; }

        @keyframes axecapBlink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }

        @media (max-width: 1024px) { .ticker-grid { grid-template-columns: repeat(3, 1fr); } }
        @media (max-width: 640px) { .ticker-grid { grid-template-columns: repeat(2, 1fr); } }
        }

        /* ═══════════════════════════════════════════
           DAILY FEED
           ═══════════════════════════════════════════ */

        .feed-timeline {
            position: relative;
            padding-left: var(--space-8);
        }

        .feed-timeline::before {
            content: '';
            position: absolute;
            left: 11px;
            top: 8px;
            bottom: 8px;
            width: 2px;
            background: linear-gradient(to bottom, var(--accent), var(--accent-secondary), var(--border));
            opacity: 0.3;
        }

        .feed-item {
            position: relative;
            margin-bottom: var(--space-5);
        }

        .feed-item:nth-child(1) { animation: feedItemIn 0.4s ease 0.05s both; }
        .feed-item:nth-child(2) { animation: feedItemIn 0.4s ease 0.1s both; }
        .feed-item:nth-child(3) { animation: feedItemIn 0.4s ease 0.15s both; }
        .feed-item:nth-child(4) { animation: feedItemIn 0.4s ease 0.2s both; }
        .feed-item:nth-child(5) { animation: feedItemIn 0.4s ease 0.25s both; }
        .feed-item:nth-child(6) { animation: feedItemIn 0.4s ease 0.3s both; }
        .feed-item:nth-child(7) { animation: feedItemIn 0.4s ease 0.35s both; }
        .feed-item:nth-child(8) { animation: feedItemIn 0.4s ease 0.4s both; }

        @keyframes feedItemIn {
            from { opacity: 0; transform: translateX(-10px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .feed-dot {
            position: absolute;
            left: -25px;
            top: 6px;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--bg-secondary);
            border: 2px solid var(--accent);
        }

        .feed-dot.active {
            background: var(--accent);
            box-shadow: 0 0 12px var(--accent-glow);
        }

        .feed-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-base);
        }

        .feed-card:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
        }

        .feed-time {
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            color: var(--text-tertiary);
            margin-bottom: var(--space-2);
        }

        .feed-agent {
            font-family: 'Space Grotesk', sans-serif;
            font-weight: 600;
            font-size: 13px;
            color: var(--accent);
        }

        .feed-content {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: var(--space-2);
            line-height: 1.6;
        }

        .feed-tags {
            display: flex;
            gap: var(--space-2);
            margin-top: var(--space-3);
            flex-wrap: wrap;
        }

        .feed-tag {
            font-size: 10px;
            font-weight: 500;
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            background: rgba(255, 255, 255, 0.03);
            color: var(--text-tertiary);
            border: 1px solid var(--border);
        }

        /* ═══ PERSONAL OPS SECTIONS ═══ */
        .activity-grid,
        .dna-grid,
        .memory-grid,
        .skills-grid,
        .okr-grid {
            display: grid;
            gap: var(--space-5);
        }

        .activity-grid,
        .dna-grid,
        .skills-grid,
        .okr-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }

        .memory-grid {
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        }

        .activity-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: var(--space-2);
        }

        .value-list,
        .memory-list,
        .skills-list,
        .okr-list,
        .todo-list {
            display: grid;
            gap: var(--space-3);
        }

        .value-item,
        .memory-item,
        .skill-item,
        .okr-item,
        .todo-item {
            padding: var(--space-3);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            background: var(--bg-card-solid);
        }

        .value-title,
        .memory-title,
        .skill-title,
        .okr-title,
        .todo-title {
            font-weight: 600;
            margin-bottom: var(--space-2);
        }

        .memory-meta {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            color: var(--text-tertiary);
            font-size: 12px;
        }

        .tag-row {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-2);
            margin-top: var(--space-2);
        }

        .tag-pill {
            padding: 2px 10px;
            border-radius: 999px;
            font-size: 11px;
            background: rgba(245, 158, 11, 0.12);
            color: var(--accent);
            border: 1px solid rgba(245, 158, 11, 0.25);
        }

        .skill-level {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: var(--space-2);
        }

        .time-block {
            padding: var(--space-3);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            background: var(--bg-card-solid);
            display: grid;
            gap: var(--space-1);
            font-size: 12px;
            color: var(--text-secondary);
        }

        .time-block strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .priority-badge {
            padding: 2px 8px;
            border-radius: 999px;
            font-size: 11px;
            font-weight: 600;
            border: 1px solid transparent;
        }

        .priority-high {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.12);
            border-color: rgba(239, 68, 68, 0.3);
        }

        /* Skills Inventory */
        .skill-list {
            display: grid;
            gap: var(--space-2);
        }

        .skill-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-sm);
            background: var(--bg-card-solid);
            border: 1px solid var(--border);
        }

        .skill-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .skill-agent {
            font-size: 12px;
            color: var(--text-tertiary);
        }

        /* ═══════════════════════════════════════════
           QUICK LINKS
           ═══════════════════════════════════════════ */

        .links-section {
            margin-bottom: var(--space-8);
        }

        .links-section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: var(--space-4);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: var(--space-3);
        }

        .link-card {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: var(--space-4);
            text-decoration: none;
            color: var(--text-primary);
            transition: all var(--transition-fast);
            cursor: pointer;
        }

        .link-card:hover {
            border-color: var(--accent);
            background: var(--accent-muted);
            transform: translateX(4px);
        }

        .link-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            flex-shrink: 0;
            background: rgba(255, 255, 255, 0.04);
        }

        .link-info {
            flex: 1;
            min-width: 0;
        }

        .link-name {
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .link-url {
            font-size: 10px;
            color: var(--text-tertiary);
            font-family: 'JetBrains Mono', monospace;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .link-arrow {
            color: var(--text-tertiary);
            font-size: 12px;
            transition: all var(--transition-fast);
        }

        .link-card:hover .link-arrow {
            color: var(--accent);
            transform: translateX(3px);
        }

        /* ═══════════════════════════════════════════
           IDEAS VAULT
           ═══════════════════════════════════════════ */

        .ideas-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-6);
        }

        .ideas-filters {
            display: flex;
            gap: var(--space-2);
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: var(--space-2) var(--space-4);
            border-radius: 20px;
            font-size: 11px;
            font-weight: 500;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all var(--transition-fast);
            font-family: inherit;
        }

        .filter-btn:hover, .filter-btn.active {
            background: var(--accent-muted);
            border-color: var(--accent);
            color: var(--accent);
        }

        .filter-btn:active {
            transform: scale(0.96);
        }

        .ideas-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-4);
        }

        .idea-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--space-5);
            transition: all var(--transition-base);
        }

        .idea-card:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
            transform: translateY(-2px);
        }

        .idea-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: var(--space-3);
        }

        .idea-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 14px;
            font-weight: 600;
        }

        .idea-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: var(--space-3);
        }

        .idea-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 10px;
            color: var(--text-tertiary);
            font-family: 'JetBrains Mono', monospace;
        }

        /* ═══════════════════════════════════════════
           KANBAN BOARD
           ═══════════════════════════════════════════ */

        .kanban-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-6);
        }

        .kanban-board {
            display: flex;
            gap: var(--space-5);
            overflow-x: auto;
            min-height: 500px;
            padding-bottom: var(--space-4);
        }

        .kanban-board::-webkit-scrollbar {
            height: 6px;
        }

        .kanban-board::-webkit-scrollbar-track {
            background: transparent;
        }

        .kanban-board::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .kanban-column {
            flex: 1;
            min-width: 260px;
            max-width: 340px;
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            display: flex;
            flex-direction: column;
            transition: all var(--transition-base);
        }

        .kanban-column.drag-over {
            border-color: var(--accent);
            box-shadow: 0 0 24px rgba(245, 158, 11, 0.12), inset 0 0 24px rgba(245, 158, 11, 0.04);
            background: rgba(245, 158, 11, 0.03);
        }

        .kanban-column-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-4) var(--space-5);
            border-bottom: 1px solid var(--border);
        }

        .kanban-column-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 13px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kanban-column-count {
            font-size: 11px;
            font-weight: 600;
            color: var(--accent);
            background: var(--accent-muted);
            padding: 2px 8px;
            border-radius: 10px;
            font-family: 'JetBrains Mono', monospace;
        }

        .kanban-column-body {
            flex: 1;
            padding: var(--space-3);
            display: flex;
            flex-direction: column;
            gap: var(--space-3);
            min-height: 80px;
        }

        .kanban-card {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: var(--space-4);
            cursor: grab;
            transition: all var(--transition-fast);
            position: relative;
        }

        .kanban-card:hover {
            border-color: var(--border-hover);
            background: var(--bg-card-hover);
            transform: translateY(-1px);
            box-shadow: var(--shadow-card);
        }

        .kanban-card:active {
            cursor: grabbing;
        }

        .kanban-card.dragging {
            opacity: 0.4;
            transform: rotate(2deg) scale(0.97);
        }

        .kanban-card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: var(--space-2);
            gap: var(--space-2);
        }

        .kanban-card-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 13px;
            font-weight: 600;
            line-height: 1.4;
        }

        .kanban-card-delete {
            background: none;
            border: none;
            color: var(--text-tertiary);
            cursor: pointer;
            font-size: 14px;
            padding: 0;
            line-height: 1;
            opacity: 0;
            transition: all var(--transition-fast);
            flex-shrink: 0;
        }

        .kanban-card:hover .kanban-card-delete {
            opacity: 1;
        }

        .kanban-card-delete:hover {
            color: var(--danger);
        }

        .kanban-card-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.5;
            margin-bottom: var(--space-3);
        }

        .kanban-card-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .kanban-priority {
            font-size: 10px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'JetBrains Mono', monospace;
        }

        .kanban-priority.high {
            color: var(--danger);
            background: rgba(239, 68, 68, 0.12);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .kanban-priority.med {
            color: var(--warning);
            background: rgba(245, 158, 11, 0.12);
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .kanban-priority.low {
            color: var(--success);
            background: rgba(34, 197, 94, 0.12);
            border: 1px solid rgba(34, 197, 94, 0.2);
        }

        .kanban-card-date {
            font-size: 10px;
            color: var(--text-tertiary);
            font-family: 'JetBrains Mono', monospace;
        }

        .kanban-empty {
            text-align: center;
            padding: var(--space-6) var(--space-3);
            color: var(--text-tertiary);
            font-size: 12px;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .kanban-board {
                min-height: 400px;
            }

            .kanban-column {
                min-width: 240px;
            }
        }

        /* ═══════════════════════════════════════════
           MODALS
           ═══════════════════════════════════════════ */

        .modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            z-index: 200;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            padding: var(--space-8);
            width: 100%;
            max-width: 500px;
            box-shadow: var(--shadow-elevated);
            animation: modalIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95) translateY(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .modal-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: var(--space-6);
        }

        .form-group {
            margin-bottom: var(--space-5);
        }

        .form-label {
            display: block;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: var(--space-2);
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: var(--space-3) var(--space-4);
            font-family: inherit;
            font-size: 13px;
            color: var(--text-primary);
            outline: none;
            transition: all var(--transition-fast);
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            border-color: var(--border-active);
            box-shadow: 0 0 0 3px var(--accent-muted);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-select {
            appearance: none;
            cursor: pointer;
        }

        .modal-actions {
            display: flex;
            gap: var(--space-3);
            justify-content: flex-end;
            margin-top: var(--space-6);
        }

        /* ═══════════════════════════════════════════
           COMMAND PALETTE
           ═══════════════════════════════════════════ */

        .command-palette-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            z-index: 300;
            align-items: flex-start;
            justify-content: center;
            padding-top: 18vh;
        }

        .command-palette-overlay.active {
            display: flex;
        }

        .command-palette {
            background: var(--bg-elevated);
            border: 1px solid var(--border);
            border-radius: var(--radius-xl);
            width: 100%;
            max-width: 580px;
            box-shadow: 0 25px 60px rgba(0,0,0,0.5), 0 0 60px var(--accent-glow);
            overflow: hidden;
            animation: cmdIn 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes cmdIn {
            from { opacity: 0; transform: scale(0.96) translateY(-10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }

        .command-header {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-4) var(--space-5);
            border-bottom: 1px solid var(--border);
        }

        .command-search-icon {
            color: var(--accent);
            font-size: 16px;
            flex-shrink: 0;
        }

        .command-input {
            width: 100%;
            background: transparent;
            border: none;
            font-family: inherit;
            font-size: 15px;
            color: var(--text-primary);
            outline: none;
        }

        .command-input::placeholder {
            color: var(--text-tertiary);
        }

        .command-section-label {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-tertiary);
            padding: var(--space-3) var(--space-5) var(--space-1);
        }

        .command-results {
            max-height: 340px;
            overflow-y: auto;
            padding: var(--space-2);
        }

        .command-item {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all var(--transition-fast);
        }

        .command-item:hover, .command-item.selected {
            background: var(--accent-muted);
        }

        .command-item.selected {
            border-left: 2px solid var(--accent);
        }

        .command-item-icon {
            width: 30px;
            height: 30px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.04);
            font-size: 13px;
            flex-shrink: 0;
        }

        .command-item-text {
            font-size: 13px;
            font-weight: 500;
            flex: 1;
        }

        .command-item-hint {
            font-size: 11px;
            color: var(--text-tertiary);
        }

        .command-item-kbd {
            font-family: 'JetBrains Mono', monospace;
            font-size: 10px;
            color: var(--text-tertiary);
            background: rgba(255,255,255,0.04);
            padding: 2px 6px;
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .command-footer {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: var(--space-3) var(--space-5);
            border-top: 1px solid var(--border);
            font-size: 10px;
            color: var(--text-tertiary);
        }

        .command-footer kbd {
            font-family: 'JetBrains Mono', monospace;
            background: rgba(255,255,255,0.04);
            padding: 1px 5px;
            border-radius: 3px;
            border: 1px solid var(--border);
            font-size: 10px;
        }

        /* ═══════════════════════════════════════════
           RESPONSIVE
           ═══════════════════════════════════════════ */

        @media (max-width: 1024px) {
            .stats-row { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.open { transform: translateX(0); }
            .sidebar-backdrop {
                display: none;
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 99;
            }
            .sidebar-backdrop.active { display: block; }
            .main { margin-left: 0; }
            .mobile-menu-btn { display: flex; }
            .content { padding: var(--space-5); }
            .stats-row { grid-template-columns: repeat(2, 1fr); }
            .agents-grid { grid-template-columns: 1fr; }
            .projects-grid { grid-template-columns: 1fr; }
            .topbar-search { display: none; }
            .topbar-clock { display: none; }
            .links-grid { grid-template-columns: 1fr; }
        }

        @media (max-width: 480px) {
            .stats-row { grid-template-columns: 1fr; }
        }

        /* ═══════════════════════════════════════════
           UTILITY
           ═══════════════════════════════════════════ */

        .text-gradient {
            background: var(--gradient-accent);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glow-line {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent), var(--accent-secondary), transparent);
            margin: var(--space-6) 0;
            opacity: 0.3;
        }

        .empty-state {
            text-align: center;
            padding: var(--space-16) var(--space-8);
            color: var(--text-tertiary);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: var(--space-4);
            opacity: 0.3;
        }

        .empty-state-text {
            font-size: 14px;
        }

        /* Stagger animation for grid children */
        .stagger-in > *:nth-child(1) { animation: cardIn 0.4s ease 0.03s both; }
        .stagger-in > *:nth-child(2) { animation: cardIn 0.4s ease 0.06s both; }
        .stagger-in > *:nth-child(3) { animation: cardIn 0.4s ease 0.09s both; }
        .stagger-in > *:nth-child(4) { animation: cardIn 0.4s ease 0.12s both; }
        .stagger-in > *:nth-child(5) { animation: cardIn 0.4s ease 0.15s both; }
        .stagger-in > *:nth-child(6) { animation: cardIn 0.4s ease 0.18s both; }
        .stagger-in > *:nth-child(7) { animation: cardIn 0.4s ease 0.21s both; }
        .stagger-in > *:nth-child(8) { animation: cardIn 0.4s ease 0.24s both; }
        .stagger-in > *:nth-child(9) { animation: cardIn 0.4s ease 0.27s both; }

        @keyframes cardIn {
            from { opacity: 0; transform: translateY(12px) scale(0.97); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* ═══ MODEL COUNSEL ═══ */
        .model-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: var(--space-3);
        }

        .model-checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .model-checkbox input {
            display: none;
        }

        .model-label {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-3) var(--space-4);
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--bg-card-solid);
            font-size: 13px;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all var(--transition-fast);
            width: 100%;
        }

        .model-checkbox input:checked + .model-label {
            border-color: var(--model-color, var(--accent));
            background: rgba(255,255,255,0.02);
            color: var(--text-primary);
            box-shadow: 0 0 0 1px var(--model-color, var(--accent)), 0 0 20px rgba(0,0,0,0.2);
        }

        .model-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--model-color, var(--accent));
            opacity: 0.4;
            transition: opacity var(--transition-fast);
        }

        .model-checkbox input:checked + .model-label .model-dot {
            opacity: 1;
            box-shadow: 0 0 8px var(--model-color, var(--accent));
        }

        .counsel-textarea {
            width: 100%;
            min-height: 120px;
            padding: var(--space-4);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            background: var(--bg-input);
            color: var(--text-primary);
            font-family: inherit;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            transition: all var(--transition-fast);
        }

        .counsel-textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px var(--accent-muted);
        }

        .counsel-textarea::placeholder {
            color: var(--text-tertiary);
        }

        .counsel-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: var(--space-12);
            color: var(--text-secondary);
            gap: var(--space-4);
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .counsel-results {
            animation: fadeIn 0.3s ease;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .results-header h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .model-responses-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: var(--space-4);
        }

        .model-response-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            overflow: hidden;
            transition: all var(--transition-fast);
        }

        .model-response-card:hover {
            border-color: var(--border-hover);
            box-shadow: var(--shadow-elevated);
        }

        .model-response-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-3) var(--space-4);
            border-bottom: 1px solid var(--border);
            background: var(--bg-elevated);
        }

        .model-response-name {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-weight: 600;
            font-size: 13px;
        }

        .model-response-name .model-dot {
            opacity: 1;
        }

        .model-response-meta {
            display: flex;
            gap: var(--space-3);
            font-size: 11px;
            color: var(--text-tertiary);
            font-family: 'JetBrains Mono', monospace;
        }

        .model-response-content {
            padding: var(--space-4);
            font-size: 13px;
            line-height: 1.7;
            color: var(--text-secondary);
            max-height: 300px;
            overflow-y: auto;
        }

        .model-response-content::-webkit-scrollbar {
            width: 6px;
        }

        .model-response-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .model-response-content::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 3px;
        }

        .model-response-error {
            color: var(--danger);
            padding: var(--space-4);
            font-size: 13px;
        }

        .counsel-combined {
            border-color: var(--accent);
            box-shadow: 0 0 30px var(--accent-glow);
        }

        .counsel-combined .card-header {
            background: var(--gradient-accent);
            color: white;
        }

        .counsel-combined .card-title {
            color: white;
        }

        #combinedContent {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .model-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .model-responses-grid {
                grid-template-columns: 1fr;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* N8N NODE SYSTEM */
        .n8n-container { position: relative; }
        .n8n-grid-bg { 
            background-image: radial-gradient(circle, rgba(245,158,11,0.03) 1px, transparent 1px);
            background-size: 24px 24px;
        }
        .n8n-node { 
            background: #111; border: 1px solid #222; border-radius: 12px; 
            position: relative; overflow: hidden; transition: all 0.3s;
        }
        .n8n-node:hover { border-color: rgba(245,158,11,0.3); box-shadow: 0 0 20px rgba(245,158,11,0.05); }
        .n8n-node-header { 
            padding: 12px 16px; border-bottom: 1px solid #1A1A1A;
            display: flex; align-items: center; gap: 10px;
        }
        .n8n-node-icon { 
            width: 32px; height: 32px; border-radius: 8px; 
            display: flex; align-items: center; justify-content: center;
            font-size: 14px; font-weight: 700; flex-shrink: 0;
        }
        .n8n-node-title { font-family: 'Space Grotesk', sans-serif; font-size: 13px; font-weight: 600; color: #fff; }
        .n8n-node-subtitle { font-size: 10px; color: #666; margin-top: 2px; }
        .n8n-node-body { padding: 12px 16px; }
        .n8n-connector { 
            position: absolute; width: 8px; height: 8px; border-radius: 50%; 
            background: #333; border: 2px solid #222;
        }
        .n8n-connector.right { right: -4px; top: 50%; transform: translateY(-50%); }
        .n8n-connector.left { left: -4px; top: 50%; transform: translateY(-50%); }
        .n8n-connector.active { background: #F59E0B; border-color: #F59E0B; box-shadow: 0 0 6px rgba(245,158,11,0.4); }
        .n8n-flow-line { 
            position: absolute; height: 2px; background: linear-gradient(90deg, #F59E0B, rgba(245,158,11,0.1));
        }
        .n8n-badge { 
            display: inline-flex; align-items: center; gap: 4px;
            padding: 2px 8px; border-radius: 4px; font-size: 10px;
            font-family: 'JetBrains Mono', monospace;
            background: rgba(245,158,11,0.1); color: #F59E0B;
        }
        .n8n-search { 
            width: 100%; background: #0F0F0F; border: 1px solid #222; border-radius: 8px;
            padding: 10px 14px 10px 36px; color: #fff; font-size: 13px;
            font-family: 'Inter', sans-serif;
        }
        .n8n-search:focus { outline: none; border-color: #F59E0B; }
        .n8n-search-wrap { position: relative; }
        .n8n-search-icon { position: absolute; left: 12px; top: 50%; transform: translateY(-50%); color: #666; font-size: 14px; }

        /* PIN GATE */
        .pin-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.85); backdrop-filter: blur(8px); z-index: 9999; display: flex; align-items: center; justify-content: center; }
        .pin-modal { background: #0F0F0F; border: 1px solid #222; border-radius: 16px; padding: 40px; text-align: center; width: 320px; }
        .pin-header { font-family: 'Space Grotesk', sans-serif; font-size: 14px; font-weight: 700; color: #F59E0B; letter-spacing: 0.15em; text-transform: uppercase; margin-bottom: 8px; }
        .pin-subtitle { font-size: 13px; color: #666; margin-bottom: 24px; }
        .pin-dots { display: flex; justify-content: center; gap: 12px; margin-bottom: 24px; }
        .pin-dot { width: 14px; height: 14px; border-radius: 50%; border: 2px solid #333; background: transparent; transition: all 0.2s; display: inline-block; }
        .pin-dot.filled { background: #F59E0B; border-color: #F59E0B; }
        .pin-dot.error { border-color: #EF4444; background: #EF4444; }
        .pin-error { color: #EF4444; font-size: 12px; margin-bottom: 12px; font-family: 'JetBrains Mono', monospace; }
        .pin-keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; max-width: 240px; margin: 0 auto; }
        .pin-key { background: #1A1A1A; border: 1px solid #222; border-radius: 8px; padding: 14px; font-size: 18px; font-weight: 600; color: #fff; cursor: pointer; transition: all 0.15s; font-family: 'Space Grotesk', sans-serif; }
        .pin-key:hover { background: #222; border-color: #F59E0B; }
        .pin-key:active { background: #F59E0B; color: #000; }

        @media (max-width: 768px) {
            #section-activity-dashboard .n8n-container > div:first-child { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <!-- ═══════════════════════════════════════════
         PASSWORD GATE
         ═══════════════════════════════════════════ -->
    <div id="authGate" style="position:fixed;inset:0;z-index:9999;background:#0F0F0F;display:flex;align-items:center;justify-content:center;font-family:'Inter',sans-serif;">
        <div style="text-align:center;max-width:360px;width:100%;padding:0 24px;">
            <div style="width:56px;height:56px;margin:0 auto 24px;background:linear-gradient(135deg,#F59E0B,#D97706);border-radius:14px;display:flex;align-items:center;justify-content:center;font-weight:800;font-size:16px;color:white;letter-spacing:-0.5px;box-shadow:0 0 40px rgba(245,158,11,0.2);">DB</div>
            <h1 style="font-family:'Space Grotesk',sans-serif;font-size:22px;font-weight:700;color:#f0f0f5;margin-bottom:4px;letter-spacing:-0.5px;">DB TECH OS</h1>
            <p style="font-size:12px;color:#55556a;text-transform:uppercase;letter-spacing:2px;margin-bottom:32px;">Authenticate</p>
            <div style="position:relative;">
                <input id="authPassword" type="password" placeholder="Enter password" autocomplete="off" style="width:100%;background:#1A1A1A;border:1px solid rgba(51,51,51,0.6);border-radius:10px;padding:14px 16px;font-family:inherit;font-size:14px;color:#FFFFFF;outline:none;transition:border-color 0.2s,box-shadow 0.2s;" onfocus="this.style.borderColor='rgba(245,158,11,0.4)';this.style.boxShadow='0 0 0 3px rgba(245,158,11,0.1)'" onblur="this.style.borderColor='rgba(51,51,51,0.6)';this.style.boxShadow='none'">
            </div>
            <p id="authError" style="font-size:12px;color:#ef4444;margin-top:12px;opacity:0;transition:opacity 0.2s;">Incorrect password</p>
            <button id="authSubmit" onclick="attemptLogin()" style="width:100%;margin-top:16px;padding:12px;border-radius:10px;border:none;background:linear-gradient(135deg,#F59E0B,#D97706);color:white;font-family:inherit;font-size:14px;font-weight:600;cursor:pointer;transition:opacity 0.15s,transform 0.15s;" onmousedown="this.style.transform='scale(0.97)'" onmouseup="this.style.transform='scale(1)'" onmouseleave="this.style.transform='scale(1)'">Access Command Center</button>
        </div>
    </div>
    <script>
        // Simple hash for password verification (not plaintext in source)
        async function hashPass(p){const e=new TextEncoder().encode(p);const h=await crypto.subtle.digest('SHA-256',e);return Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('');}
        const PASS_HASH='df7a7302294994806fc01c2ef9f4bdb78a5d88912f77dc3a83f92e6c6c69ec29';
        // Pre-compute the hash on load
        (async()=>{
            // Check if already authenticated
            if(localStorage.getItem('dbtech-os-auth')==='1'){
                document.getElementById('authGate').style.display='none';
                document.querySelector('.app').style.display='';
                return;
            }
            const input=document.getElementById('authPassword');
            input.addEventListener('keydown',e=>{if(e.key==='Enter')attemptLogin();});
            setTimeout(()=>input.focus(),100);
        })();
        async function attemptLogin(){
            const input=document.getElementById('authPassword');
            const hash=await hashPass(input.value);
            if(hash===PASS_HASH){
                localStorage.setItem('dbtech-os-auth','1');
                document.querySelector('.app').style.display='';
                document.getElementById('authGate').style.opacity='1';
                document.getElementById('authGate').style.transition='opacity 0.3s ease';
                requestAnimationFrame(()=>{document.getElementById('authGate').style.opacity='0';});
                setTimeout(()=>{document.getElementById('authGate').style.display='none';},300);
            }else{
                const err=document.getElementById('authError');
                err.style.opacity='1';
                input.style.borderColor='#ef4444';
                input.value='';
                setTimeout(()=>{err.style.opacity='0';input.style.borderColor='rgba(255,255,255,0.08)';},2000);
            }
        }
    </script>

    <!-- Ambient Background -->
    <div class="ambient-bg">
        <div class="ambient-orb"></div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- SVG Definitions -->
    <svg style="position:absolute;width:0;height:0">
        <defs>
            <linearGradient id="sparkGradient" x1="0" y1="0" x2="0" y2="1">
                <stop offset="0%" stop-color="var(--accent)" stop-opacity="0.2"/>
                <stop offset="100%" stop-color="var(--accent)" stop-opacity="0"/>
            </linearGradient>
        </defs>
    </svg>

    <div class="app" style="display:none">
        <!-- Sidebar Backdrop (Mobile) -->
        <div class="sidebar-backdrop" id="sidebarBackdrop"></div>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="os-logo">
                    <div class="os-logo-icon">DB</div>
                    <div class="os-logo-text">
                        <span class="title">DB TECH OS</span>
                        <span class="subtitle">Command Center</span>
                    </div>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-label">Main</div>
                    <div class="nav-item active" data-section="mission-control">
                        <span class="nav-icon">⌘</span>
                        <span>Mission Control</span>
                        <span class="nav-kbd">1</span>
                    </div>
                    <div class="nav-item" data-section="model-counsel">
                        <span class="nav-icon">⚡</span>
                        <span>Model Counsel</span>
                        <span class="nav-kbd">M</span>
                    </div>
                    <div class="nav-item" data-section="projects">
                        <span class="nav-icon">◆</span>
                        <span>Projects</span>
                        <span class="nav-badge">23</span>
                    </div>
                    <div class="nav-item" data-section="markets">
                        <span class="nav-icon">◈</span>
                        <span>Markets</span>
                        <span class="nav-kbd">3</span>
                    </div>
                    <div class="nav-item" data-section="daily-feed">
                        <span class="nav-icon">▸</span>
                        <span>Daily Feed</span>
                        <span class="nav-kbd">4</span>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-label">Tools</div>
                    <div class="nav-item" data-section="quick-links">
                        <span class="nav-icon">↗</span>
                        <span>Quick Links</span>
                        <span class="nav-kbd">5</span>
                    </div>
                    <div class="nav-item" data-section="kanban">
                        <span class="nav-icon">▦</span>
                        <span>Kanban</span>
                        <span class="nav-kbd">6</span>
                    </div>
                    <div class="nav-item" data-section="ideas-vault">
                        <span class="nav-icon">✦</span>
                        <span>Ideas Vault</span>
                        <span class="nav-kbd">7</span>
                    </div>
                </div>
                <div class="nav-section">
                    <div class="nav-section-label">Operations</div>
                    <div class="nav-item" data-section="activity-dashboard">
                        <span class="nav-icon">◎</span>
                        <span>Activity Dashboard</span>
                    </div>
                    <div class="nav-item" data-section="dna">
                        <span class="nav-icon">⎈</span>
                        <span>DNA</span>
                    </div>
                    <div class="nav-item" data-section="memory-bank">
                        <span class="nav-icon">⬡</span>
                        <span>Memory Bank</span>
                    </div>
                    <div class="nav-item" data-section="skills-inventory">
                        <span class="nav-icon">⧉</span>
                        <span>Skills Inventory</span>
                    </div>
                </div>
            </nav>
            <div class="sidebar-footer">
                <div class="sidebar-greeting" id="sidebarGreeting">Good evening, <strong>Derek</strong></div>
                <div class="sidebar-time" id="sidebarTime">--:-- --</div>
                <div class="sidebar-status">
                    <span class="status-dot"></span>
                    All systems operational
                </div>
            </div>
        </aside>

        <!-- Main -->
        <main class="main">
            <!-- Top Bar -->
            <header class="topbar">
                <div class="topbar-left">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">☰</button>
                    <div>
                        <div class="topbar-title" id="topbarTitle">Mission Control</div>
                        <div class="topbar-breadcrumb">DB TECH OS / <span id="topbarBreadcrumb">Overview</span></div>
                    </div>
                </div>
                <div class="topbar-right">
                    <div class="topbar-clock" id="topbarClock">--:--</div>
                    <button class="theme-toggle" id="themeToggle" title="Toggle theme">☀</button>
                    <div class="topbar-search" id="topbarSearchBtn">
                        <span class="search-icon">⌕</span>
                        <input type="text" placeholder="Search or jump to..." id="searchInput" readonly>
                        <span class="topbar-kbd">⌘K</span>
                    </div>
                </div>
            </header>

            <div class="content">

                <!-- ═══ MISSION CONTROL ═══ -->
                <div class="section active" id="section-mission-control">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Mission Control</h1>
                            <p class="section-subtitle">Real-time overview of your entire operation</p>
                        </div>
                        <div style="display: flex; gap: var(--space-3);">
                            <button class="btn btn-sm" id="refreshBtn" onclick="refreshDashboard()">↻ Refresh</button>
                        </div>
                    </div>

                    <!-- Stats -->
                    <div class="stats-row stagger-in" id="statsRow">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-label">Active Agents</div>
                                <svg class="stat-sparkline" viewBox="0 0 48 20">
                                    <path d="M0,15 L6,12 L12,14 L18,8 L24,10 L30,5 L36,7 L42,3 L48,6">
                                        <animate attributeName="d" dur="3s" repeatCount="indefinite"
                                            values="M0,15 L6,12 L12,14 L18,8 L24,10 L30,5 L36,7 L42,3 L48,6;
                                                    M0,13 L6,14 L12,10 L18,12 L24,6 L30,8 L36,4 L42,7 L48,5;
                                                    M0,15 L6,12 L12,14 L18,8 L24,10 L30,5 L36,7 L42,3 L48,6"/>
                                    </path>
                                </svg>
                            </div>
                            <div class="stat-value" data-count="9">0</div>
                            <div class="stat-detail">All online</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-label">Active Projects</div>
                                <svg class="stat-sparkline" viewBox="0 0 48 20">
                                    <path d="M0,16 L8,12 L16,14 L24,6 L32,10 L40,4 L48,8">
                                        <animate attributeName="d" dur="4s" repeatCount="indefinite"
                                            values="M0,16 L8,12 L16,14 L24,6 L32,10 L40,4 L48,8;
                                                    M0,14 L8,10 L16,12 L24,8 L32,6 L40,9 L48,5;
                                                    M0,16 L8,12 L16,14 L24,6 L32,10 L40,4 L48,8"/>
                                    </path>
                                </svg>
                            </div>
                            <div class="stat-value" data-count="23">0</div>
                            <div class="stat-detail">18 active · 5 launched</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-label">Deployments</div>
                                <svg class="stat-sparkline" viewBox="0 0 48 20">
                                    <path d="M0,18 L6,14 L12,16 L18,10 L24,12 L30,6 L36,8 L42,2 L48,4">
                                        <animate attributeName="d" dur="5s" repeatCount="indefinite"
                                            values="M0,18 L6,14 L12,16 L18,10 L24,12 L30,6 L36,8 L42,2 L48,4;
                                                    M0,16 L6,12 L12,14 L18,8 L24,10 L30,4 L36,6 L42,5 L48,3;
                                                    M0,18 L6,14 L12,16 L18,10 L24,12 L30,6 L36,8 L42,2 L48,4"/>
                                    </path>
                                </svg>
                            </div>
                            <div class="stat-value" data-count="14">0</div>
                            <div class="stat-detail">Vercel · Active</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-label">Ideas Tracked</div>
                                <svg class="stat-sparkline" viewBox="0 0 48 20">
                                    <path d="M0,14 L8,10 L16,16 L24,8 L32,12 L40,6 L48,10">
                                        <animate attributeName="d" dur="3.5s" repeatCount="indefinite"
                                            values="M0,14 L8,10 L16,16 L24,8 L32,12 L40,6 L48,10;
                                                    M0,12 L8,14 L16,10 L24,12 L32,8 L40,10 L48,6;
                                                    M0,14 L8,10 L16,16 L24,8 L32,12 L40,6 L48,10"/>
                                    </path>
                                </svg>
                            </div>
                            <div class="stat-value" id="ideasCount" data-count="6">0</div>
                            <div class="stat-detail">2 in research</div>
                        </div>
                    </div>

                    <h2 class="agents-section-header">⚡ Agent Fleet</h2>

                    <!-- Agents Grid -->
                    <div class="agents-grid stagger-in" id="agentsGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- ═══ MODEL COUNSEL ═══ -->
                <div class="section" id="section-model-counsel">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Model Counsel</h1>
                            <p class="section-subtitle">Compare responses from multiple AI models side-by-side</p>
                        </div>
                    </div>

                    <!-- Model Selection -->
                    <div class="card" style="margin-bottom: var(--space-6);">
                        <div class="card-header">
                            <div class="card-title">Select Models</div>
                        </div>
                        <div class="card-content">
                            <div class="model-grid" id="modelSelection">
                                <label class="model-checkbox">
                                    <input type="checkbox" value="claude-opus" checked>
                                    <span class="model-label" style="--model-color: #D97706;">
                                        <span class="model-dot"></span>
                                        Claude Opus 4.6
                                    </span>
                                </label>
                                <label class="model-checkbox">
                                    <input type="checkbox" value="claude-sonnet" checked>
                                    <span class="model-label" style="--model-color: #EA580C;">
                                        <span class="model-dot"></span>
                                        Claude Sonnet 4.5
                                    </span>
                                </label>
                                <label class="model-checkbox">
                                    <input type="checkbox" value="gemini-pro" checked>
                                    <span class="model-label" style="--model-color: #2563EB;">
                                        <span class="model-dot"></span>
                                        Gemini 2.5 Pro
                                    </span>
                                </label>
                                <label class="model-checkbox">
                                    <input type="checkbox" value="gemini-flash" checked>
                                    <span class="model-label" style="--model-color: #0891B2;">
                                        <span class="model-dot"></span>
                                        Gemini 2.5 Flash
                                    </span>
                                </label>
                                <label class="model-checkbox">
                                    <input type="checkbox" value="gpt-4-turbo" checked>
                                    <span class="model-label" style="--model-color: #059669;">
                                        <span class="model-dot"></span>
                                        GPT-4 Turbo
                                    </span>
                                </label>
                                <label class="model-checkbox">
                                    <input type="checkbox" value="llama-70b" checked>
                                    <span class="model-label" style="--model-color: #7C3AED;">
                                        <span class="model-dot"></span>
                                        Llama 3.1 70B
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Question Input -->
                    <div class="card" style="margin-bottom: var(--space-6);">
                        <div class="card-header">
                            <div class="card-title">Your Question</div>
                        </div>
                        <div class="card-content">
                            <textarea id="counselQuestion" class="counsel-textarea" placeholder="Ask your question to compare responses across models..."></textarea>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: var(--space-4);">
                                <span class="text-secondary" id="charCount">0 / 2000</span>
                                <button class="btn btn-primary" id="askModelsBtn" onclick="askModels()">
                                    <span>⚡</span> Ask Selected Models
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Loading State -->
                    <div class="counsel-loading" id="counselLoading" style="display: none;">
                        <div class="loading-spinner"></div>
                        <p>Consulting the models...</p>
                    </div>

                    <!-- Results Grid -->
                    <div class="counsel-results" id="counselResults" style="display: none;">
                        <div class="results-header">
                            <h3>Model Responses</h3>
                            <span class="text-secondary" id="responseTime"></span>
                        </div>
                        <div class="model-responses-grid" id="modelResponsesGrid">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Combined Answer -->
                    <div class="card counsel-combined" id="counselCombined" style="display: none; margin-top: var(--space-6);">
                        <div class="card-header">
                            <div class="card-title">✨ Best Combined Answer</div>
                        </div>
                        <div class="card-content" id="combinedContent">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- ═══ PROJECTS ═══ -->
                <div class="section" id="section-projects">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Projects Board</h1>
                            <p class="section-subtitle">All ventures, products, and experiments</p>
                        </div>
                        <div class="ideas-filters" id="projectFilters">
                            <!-- Populated dynamically by JS -->
                        </div>
                    </div>

                    <div class="projects-grid stagger-in" id="projectsGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- ═══ MARKETS ═══ -->
                <div class="section" id="section-markets">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">AxeCap Terminal</h1>
                            <p class="section-subtitle">Real-time market intelligence</p>
                        </div>
                    </div>

                    <div class="axecap-terminal">
                        <!-- Terminal Header -->
                        <div class="axecap-header">
                            <div style="display: flex; align-items: center; gap: 16px;">
                                <span class="axecap-title">AXECAP TERMINAL</span>
                                <div class="axecap-status">
                                    <span class="dot sim"></span>
                                    <span id="axecapConnectionStatus">SIMULATED</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <span class="axecap-status" id="axecapHeaderTime"></span>
                                <button class="axecap-refresh-btn" onclick="refreshMarketData()" title="Refresh data">↻ REFRESH</button>
                            </div>
                        </div>

                        <!-- Ticker Board -->
                        <div class="ticker-grid" id="axecapTickerGrid">
                            <!-- Populated by JS -->
                        </div>

                        <!-- Watchlist Panel -->
                        <div class="watchlist-panel">
                            <div class="watchlist-header">
                                <span class="watchlist-label">⬡ Watchlist</span>
                                <div class="watchlist-add">
                                    <input type="text" class="watchlist-input" id="watchlistInput" placeholder="Symbol" maxlength="5" onkeydown="if(event.key==='Enter')addToWatchlist()">
                                    <button class="watchlist-btn" onclick="addToWatchlist()">+ ADD</button>
                                </div>
                            </div>
                            <div id="axecapWatchlist">
                                <!-- Populated by JS -->
                            </div>
                        </div>

                        <!-- News Briefing Panel -->
                        <div class="news-panel" id="axecapNewsPanel">
                            <!-- Populated by JS -->
                        </div>

                        <!-- Status Bar -->
                        <div class="axecap-statusbar">
                            <div class="axecap-statusbar-left">
                                <span>AXECAP TERMINAL v1.0</span>
                                <span>|</span>
                                <span class="status-sim" id="axecapStatusMode">⬤ SIMULATED</span>
                            </div>
                            <div class="axecap-statusbar-right">
                                <span id="axecapLastRefresh">Last refresh: --:--:--</span>
                                <span>|</span>
                                <span id="axecapNextRefresh">Next: 15:00</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ═══ DAILY FEED ═══ -->
                <div class="section" id="section-daily-feed">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Daily Feed</h1>
                            <p class="section-subtitle" id="feedDate">Loading date...</p>
                        </div>
                    </div>
                    <div class="feed-timeline" id="feedTimeline">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- ═══ QUICK LINKS ═══ -->
                <div class="section" id="section-quick-links">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Quick Links</h1>
                            <p class="section-subtitle">All deployments, repos, bots, and tools in one place</p>
                        </div>
                    </div>

                    <div class="links-section">
                        <div class="links-section-title">▲ Vercel Deployments</div>
                        <div class="links-grid" id="vercelLinks"></div>
                    </div>
                    <div class="links-section">
                        <div class="links-section-title">◆ GitHub Repos</div>
                        <div class="links-grid" id="githubLinks"></div>
                    </div>
                    <div class="links-section">
                        <div class="links-section-title">✈ Telegram Bots</div>
                        <div class="links-grid" id="telegramLinks"></div>
                    </div>
                    <div class="links-section">
                        <div class="links-section-title">⚡ Useful Tools</div>
                        <div class="links-grid" id="toolLinks"></div>
                    </div>
                </div>

                <!-- ═══ KANBAN BOARD ═══ -->
                <div class="section" id="section-kanban">
                    <div class="kanban-header">
                        <div>
                            <h1 class="section-title">Kanban Board</h1>
                            <p class="section-subtitle">Drag cards between columns to track progress</p>
                        </div>
                        <button class="btn btn-primary" onclick="openKanbanModal()">+ Add Card</button>
                    </div>

                    <div class="kanban-board" id="kanbanBoard">
                        <div class="kanban-column" data-column="backlog" ondragover="kanbanDragOver(event)" ondragleave="kanbanDragLeave(event)" ondrop="kanbanDrop(event)">
                            <div class="kanban-column-header">
                                <span class="kanban-column-title">Backlog</span>
                                <span class="kanban-column-count" id="count-backlog">0</span>
                            </div>
                            <div class="kanban-column-body" id="col-backlog"></div>
                        </div>
                        <div class="kanban-column" data-column="progress" ondragover="kanbanDragOver(event)" ondragleave="kanbanDragLeave(event)" ondrop="kanbanDrop(event)">
                            <div class="kanban-column-header">
                                <span class="kanban-column-title">In Progress</span>
                                <span class="kanban-column-count" id="count-progress">0</span>
                            </div>
                            <div class="kanban-column-body" id="col-progress"></div>
                        </div>
                        <div class="kanban-column" data-column="review" ondragover="kanbanDragOver(event)" ondragleave="kanbanDragLeave(event)" ondrop="kanbanDrop(event)">
                            <div class="kanban-column-header">
                                <span class="kanban-column-title">Review</span>
                                <span class="kanban-column-count" id="count-review">0</span>
                            </div>
                            <div class="kanban-column-body" id="col-review"></div>
                        </div>
                        <div class="kanban-column" data-column="done" ondragover="kanbanDragOver(event)" ondragleave="kanbanDragLeave(event)" ondrop="kanbanDrop(event)">
                            <div class="kanban-column-header">
                                <span class="kanban-column-title">Done</span>
                                <span class="kanban-column-count" id="count-done">0</span>
                            </div>
                            <div class="kanban-column-body" id="col-done"></div>
                        </div>
                    </div>
                </div>

                <!-- ═══ IDEAS VAULT ═══ -->
                <div class="section" id="section-ideas-vault">
                    <div class="ideas-header">
                        <div>
                            <h1 class="section-title">Ideas Vault</h1>
                            <p class="section-subtitle">Capture, track, and evolve every idea</p>
                        </div>
                        <button class="btn btn-primary" onclick="openNewIdea()">+ New Idea</button>
                    </div>

                    <div class="ideas-filters" style="margin-bottom: var(--space-6);">
                        <button class="filter-btn active" data-idea-filter="all">All</button>
                        <button class="filter-btn" data-idea-filter="new">New</button>
                        <button class="filter-btn" data-idea-filter="researching">Researching</button>
                        <button class="filter-btn" data-idea-filter="building">Building</button>
                        <button class="filter-btn" data-idea-filter="launched">Launched</button>
                        <button class="filter-btn" data-idea-filter="killed">Killed</button>
                    </div>

                    <div class="ideas-grid stagger-in" id="ideasGrid"></div>
                </div>

                <!-- ═══ ACTIVITY DASHBOARD ═══ -->
                <div class="section" id="section-activity-dashboard">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Activity Dashboard</h1>
                            <p class="section-subtitle">Live system telemetry · Agent activity · Deploy status</p>
                        </div>
                        <div style="display:flex; gap:8px; align-items:center;">
                            <span class="n8n-badge"><span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:#10B981;margin-right:4px;"></span> Live</span>
                        </div>
                    </div>

                    <div class="n8n-container n8n-grid-bg" style="padding: 20px; border-radius: 12px;">
                        <div style="display:grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px;">
                            <div class="n8n-node" style="text-align:center; padding: 16px;">
                                <div style="font-family:'JetBrains Mono',monospace; font-size:24px; font-weight:700; color:#F59E0B;">9</div>
                                <div style="font-size:10px; color:#666; text-transform:uppercase; letter-spacing:0.05em; margin-top:4px;">Active Agents</div>
                            </div>
                            <div class="n8n-node" style="text-align:center; padding: 16px;">
                                <div style="font-family:'JetBrains Mono',monospace; font-size:24px; font-weight:700; color:#10B981;">28</div>
                                <div style="font-size:10px; color:#666; text-transform:uppercase; letter-spacing:0.05em; margin-top:4px;">Projects</div>
                            </div>
                            <div class="n8n-node" style="text-align:center; padding: 16px;">
                                <div style="font-family:'JetBrains Mono',monospace; font-size:24px; font-weight:700; color:#3B82F6;">147</div>
                                <div style="font-size:10px; color:#666; text-transform:uppercase; letter-spacing:0.05em; margin-top:4px;">Commits (7d)</div>
                            </div>
                            <div class="n8n-node" style="text-align:center; padding: 16px;">
                                <div style="font-family:'JetBrains Mono',monospace; font-size:24px; font-weight:700; color:#8B5CF6;">23</div>
                                <div style="font-size:10px; color:#666; text-transform:uppercase; letter-spacing:0.05em; margin-top:4px;">Deploys (7d)</div>
                            </div>
                        </div>

                        <div class="n8n-node" style="max-height: 500px; overflow-y: auto;">
                            <div class="n8n-node-header">
                                <div class="n8n-node-icon" style="background: rgba(16,185,129,0.1); color: #10B981;">◎</div>
                                <div>
                                    <div class="n8n-node-title">Activity Stream</div>
                                    <div class="n8n-node-subtitle">Last 24 hours</div>
                                </div>
                            </div>
                            <div class="n8n-node-body" id="activityStream"></div>
                        </div>
                    </div>
                </div>

                <!-- ═══ DNA SECTION ═══ -->
                <div class="section" id="section-dna">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">DNA</h1>
                            <p class="section-subtitle">Core principles · Decision filters · Operating system</p>
                        </div>
                    </div>

                    <div class="n8n-container n8n-grid-bg" style="padding: 20px; border-radius: 12px;">
                        <div class="n8n-node" style="max-width: 400px; margin: 0 auto 24px; border-color: rgba(245,158,11,0.3);">
                            <div class="n8n-connector right active"></div>
                            <div class="n8n-connector left active"></div>
                            <div style="padding: 20px; text-align: center;">
                                <div style="font-family:'Space Grotesk',sans-serif; font-size:20px; font-weight:700; color:#F59E0B; letter-spacing:0.05em;">DB TECH</div>
                                <div style="font-size:12px; color:#666; margin-top:4px;">Fueled by Caffeine and Chaos</div>
                                <div style="margin-top:12px; display:flex; justify-content:center; gap:8px;">
                                    <span class="n8n-badge">Builder</span>
                                    <span class="n8n-badge">Dad of 7</span>
                                    <span class="n8n-badge">Trader</span>
                                </div>
                            </div>
                        </div>
                        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px;" id="dnaGrid"></div>
                    </div>
                </div>

                <!-- ═══ MEMORY BANK ═══ -->
                <div class="section" id="section-memory-bank">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Memory Bank</h1>
                            <p class="section-subtitle">Knowledge graph · Decisions · Context</p>
                        </div>
                        <div class="n8n-badge">17 entries</div>
                    </div>

                    <div class="n8n-container n8n-grid-bg" style="padding: 20px; border-radius: 12px; min-height: 500px;">
                        <div class="n8n-search-wrap" style="margin-bottom: 20px;">
                            <span class="n8n-search-icon">⌕</span>
                            <input type="text" class="n8n-search" id="memorySearch" placeholder="Search memories, decisions, context..." oninput="filterMemories(this.value)">
                        </div>
                        <div class="memory-timeline" id="memoryTimeline"></div>
                    </div>
                </div>

                <!-- ═══ SKILLS INVENTORY ═══ -->
                <div class="section" id="section-skills-inventory">
                    <div class="section-header">
                        <div>
                            <h1 class="section-title">Skills Inventory</h1>
                            <p class="section-subtitle">Agent capability matrix · Interconnected skill web</p>
                        </div>
                        <div class="n8n-badge">9 agents</div>
                    </div>

                    <div class="n8n-container n8n-grid-bg" style="padding: 20px; border-radius: 12px;">
                        <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 12px;" id="agentSkillsGrid"></div>
                    </div>
                </div>

            </div>

            <!-- PIN Gate -->
            <div class="pin-overlay" id="pinOverlay" style="display:none;">
                <div class="pin-modal">
                    <div class="pin-header">OPERATIONS ACCESS</div>
                    <div class="pin-subtitle">Enter 4-digit PIN</div>
                    <div class="pin-dots" id="pinDots">
                        <span class="pin-dot"></span>
                        <span class="pin-dot"></span>
                        <span class="pin-dot"></span>
                        <span class="pin-dot"></span>
                    </div>
                    <div class="pin-error" id="pinError" style="display:none;">Invalid PIN</div>
                    <div class="pin-keypad">
                        <button class="pin-key" onclick="pinInput('1')">1</button>
                        <button class="pin-key" onclick="pinInput('2')">2</button>
                        <button class="pin-key" onclick="pinInput('3')">3</button>
                        <button class="pin-key" onclick="pinInput('4')">4</button>
                        <button class="pin-key" onclick="pinInput('5')">5</button>
                        <button class="pin-key" onclick="pinInput('6')">6</button>
                        <button class="pin-key" onclick="pinInput('7')">7</button>
                        <button class="pin-key" onclick="pinInput('8')">8</button>
                        <button class="pin-key" onclick="pinInput('9')">9</button>
                        <button class="pin-key" onclick="pinClear()">CLR</button>
                        <button class="pin-key" onclick="pinInput('0')">0</button>
                        <button class="pin-key" onclick="pinBackspace()">⌫</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- New Idea Modal -->
    <div class="modal-overlay" id="ideaModal">
        <div class="modal">
            <h2 class="modal-title">✦ New Idea</h2>
            <div class="form-group">
                <label class="form-label">Title</label>
                <input type="text" class="form-input" id="ideaTitle" placeholder="What's the idea?">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-textarea" id="ideaDesc" placeholder="Describe the idea, market, opportunity..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Status</label>
                <select class="form-select" id="ideaStatus">
                    <option value="new">🆕 New</option>
                    <option value="researching">🔍 Researching</option>
                    <option value="building">🔨 Building</option>
                    <option value="launched">🚀 Launched</option>
                    <option value="killed">💀 Killed</option>
                </select>
            </div>
            <div class="modal-actions">
                <button class="btn" onclick="closeNewIdea()">Cancel</button>
                <button class="btn btn-primary" onclick="saveIdea()">Save Idea</button>
            </div>
        </div>
    </div>

    <!-- Kanban Card Modal -->
    <div class="modal-overlay" id="kanbanModal">
        <div class="modal">
            <h2 class="modal-title">▦ New Kanban Card</h2>
            <div class="form-group">
                <label class="form-label">Title</label>
                <input type="text" class="form-input" id="kanbanTitle" placeholder="What needs to be done?">
            </div>
            <div class="form-group">
                <label class="form-label">Description</label>
                <textarea class="form-textarea" id="kanbanDesc" placeholder="Add details (optional)..."></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">Column</label>
                <select class="form-select" id="kanbanColumn">
                    <option value="backlog">📋 Backlog</option>
                    <option value="progress">🔨 In Progress</option>
                    <option value="review">🔍 Review</option>
                    <option value="done">✅ Done</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Priority</label>
                <select class="form-select" id="kanbanPriority">
                    <option value="low">🟢 Low</option>
                    <option value="med">🟡 Medium</option>
                    <option value="high">🔴 High</option>
                </select>
            </div>
            <div class="modal-actions">
                <button class="btn" onclick="closeKanbanModal()">Cancel</button>
                <button class="btn btn-primary" onclick="saveKanbanCard()">Add Card</button>
            </div>
        </div>
    </div>

    <!-- Command Palette -->
    <div class="command-palette-overlay" id="commandPalette">
        <div class="command-palette">
            <div class="command-header">
                <span class="command-search-icon">⌕</span>
                <input type="text" class="command-input" id="commandInput" placeholder="Type a command or search...">
            </div>
            <div class="command-section-label">Navigation</div>
            <div class="command-results" id="commandResults"></div>
            <div class="command-footer">
                <div><kbd>↑↓</kbd> Navigate &nbsp; <kbd>↵</kbd> Select &nbsp; <kbd>Esc</kbd> Close</div>
                <div>DB Tech OS</div>
            </div>
        </div>
    </div>

    <script>
        /* ═══════════════════════════════════════════
           DB TECH OS — Engine v2.0
           Premium Command Center
           ═══════════════════════════════════════════ */

        // ─── DATA ───────────────────────────────────

        const AGENTS = [
            { id: 'milo', name: 'Milo', role: 'Head Personal Assistant', emoji: '🧠', color: '#F59E0B', status: 'online', task: 'Coordinating agent fleet and overnight deliveries', lastActive: 'Just now' },
            { id: 'bobby', name: 'Bobby', role: 'Market Analyst', emoji: '📊', color: '#f472b6', status: 'online', task: 'Morning market brief - watching NVDA earnings setup', lastActive: '5 min ago' },
            { id: 'wendy', name: 'Wendy', role: 'Wellness & Mindset Coach', emoji: '🧘', color: '#a78bfa', status: 'online', task: 'Crafting weekly reflection prompts for Soul Solace', lastActive: '12 min ago' },
            { id: 'anders', name: 'Anders', role: 'Full-Stack Architect', emoji: '⚡', color: '#D97706', status: 'online', task: 'Rebuilding DB Tech OS with streaming architecture', lastActive: '1 min ago' },
            { id: 'paula', name: 'Paula', role: 'Creative Director', emoji: '✦', color: '#f59e0b', status: 'online', task: 'Designing Concrete Before Curtains landing page', lastActive: 'Just now' },
            { id: 'tony', name: 'Tony', role: 'Restaurant Operations', emoji: '🍽️', color: '#ef4444', status: 'online', task: 'Menu optimization and operational workflows for Bobola\'s', lastActive: '20 min ago' },
            { id: 'remy', name: 'Remy', role: 'Marketing Director', emoji: '📣', color: '#34d399', status: 'online', task: 'Planning social campaigns for Sunday Squares launch', lastActive: '8 min ago' },
            { id: 'dwight', name: 'Dwight', role: 'Systems & Security', emoji: '🔒', color: '#64748b', status: 'online', task: 'Monitoring infrastructure and running security audits', lastActive: '15 min ago' },
            { id: 'dax', name: 'Dax', role: 'Content Strategist', emoji: '✍️', color: '#fb923c', status: 'online', task: 'Writing content for Signal & Noise and Boundless blog', lastActive: '10 min ago' }
        ];

        const PROJECTS = [
            // ── Top 8 ──
            { name: 'Soul Solace', desc: 'Mindfulness and wellness app. Guided reflections, journaling, and daily calm.', status: 'building', progress: 45, color: '#a78bfa', url: 'soulsolace.vercel.app', repo: 'Soulsolace', priority: 0 },
            { name: 'Sunday Squares', desc: 'Football squares app. Weekly pools, live scoring, and easy management.', status: 'building', progress: 35, color: '#fb923c', url: 'sunday-squares.vercel.app', repo: 'SundaySquares', priority: 0 },
            { name: 'Boundless', desc: 'Journaling app. Thoughts on building, creating, and living without limits.', status: 'building', progress: 60, color: '#34d399', url: 'boundless-ochre.vercel.app', repo: 'boundless', priority: 0 },
            { name: 'Ticker', desc: 'Kids investing app. Teaching the next generation about markets and money.', status: 'building', progress: 40, color: '#22d3ee', url: 'tick-r.vercel.app', repo: 'tickR', priority: 0 },
            { name: 'Spend Signal', desc: 'Personal finance tracking and spending analysis dashboard.', status: 'building', progress: 70, color: '#06b6d4', url: 'spendsignal.vercel.app', repo: 'spendsignal', priority: 0 },
            { name: 'Concrete Before Curtains', desc: 'Content brand about building foundations first. Substance over aesthetics.', status: 'shaping', progress: 25, color: '#94a3b8', url: '#', repo: '', priority: 0 },
            { name: 'Mojo', desc: 'Coming soon.', status: 'spark', progress: 10, color: '#f59e0b', url: '#', repo: '', priority: 0 },
            { name: 'Signal & Noise', desc: 'Daily market newsletter separating signal from noise in financial markets.', status: 'building', progress: 80, color: '#f472b6', url: '#', repo: 'signal-and-noise', priority: 0 },
            // ── Remaining ──
            { name: 'dbtech45.com', desc: 'Personal portfolio and digital home base. The hub for everything DB Tech.', status: 'shipped', progress: 100, color: '#fbbf24', url: 'dbtech45.vercel.app', repo: 'dbtech45', priority: 0 },
            { name: 'MenuSparks', desc: 'Menu special optimization. Helping restaurants maximize their menu performance.', status: 'building', progress: 50, color: '#f59e0b', url: 'menusparks.vercel.app', repo: 'menusparks', priority: 0 },
            { name: 'Bobola\'s Site', desc: 'Official website for Bobola\'s restaurant. Menu, hours, and ordering.', status: 'shipped', progress: 100, color: '#ef4444', url: 'bobolas-site.vercel.app', repo: 'Bobolas-site', priority: 0 },
            { name: 'PicForge', desc: 'AI image generation and editing tool. Create and transform visuals.', status: 'building', progress: 55, color: '#FBBF24', url: 'picforge.vercel.app', repo: 'picforge', priority: 0 },
            { name: 'Mockavio', desc: 'Corporate video editing and production tool.', status: 'planning', progress: 30, color: '#64748b', url: '#', repo: 'mockavio', priority: 0 },
            { name: 'Pour Plan', desc: 'Drink recipe and bar management app.', status: 'building', progress: 35, color: '#f472b6', url: '#', repo: 'pourplan', priority: 0 },
            { name: 'Back Nine', desc: 'Golf scoring and handicap tracking app.', status: 'shipped', progress: 100, color: '#22c55e', url: 'backnine-ten.vercel.app', repo: 'backnine', priority: 0 },
            { name: 'Locals Diner', desc: 'Local restaurant discovery and community dining guide.', status: 'shipped', progress: 100, color: '#fb923c', url: 'localsdiner.vercel.app', repo: 'Localsdiner', priority: 0 },
            { name: 'BullishIQ', desc: 'Market intelligence and trading education platform.', status: 'shaping', progress: 25, color: '#10b981', url: '#', repo: 'bullishIQ', priority: 0 },
            { name: 'StockFool', desc: 'Stock market analysis and foolproof investing tools.', status: 'spark', progress: 20, color: '#D97706', url: '#', repo: 'stockfool', priority: 0 },
            { name: 'InventoryBuddy', desc: 'Inventory management and tracking for small businesses.', status: 'building', progress: 50, color: '#14b8a6', url: 'inventorybuddy-delta.vercel.app', repo: 'inventorybuddy', priority: 0 },
            { name: 'Scheduler', desc: 'Scheduling and calendar management tool.', status: 'building', progress: 45, color: '#8b5cf6', url: 'scheduler-hazel-three.vercel.app', repo: 'Scheduler', priority: 0 },
            { name: 'Santa25', desc: 'Christmas gift exchange and Secret Santa organizer.', status: 'shipped', progress: 100, color: '#ef4444', url: 'santa25.vercel.app', repo: 'santa25', priority: 0 },
            { name: '7LL', desc: '7 Layer Labs. The parent brand and lab for all projects.', status: 'planning', progress: 30, color: '#F59E0B', url: '#', repo: '7LL', priority: 0 },
            { name: 'YourWebsiteSucks', desc: 'Brutally honest website review and roast service.', status: 'spark', progress: 20, color: '#f87171', url: '#', repo: 'Yourwebsitesucks', priority: 0 }
        ];

        // ─── AXECAP TERMINAL DATA ────────────────
        const AXECAP_CONFIG = {
            defaultTickers: ['ES', 'NQ', 'SPY', 'VIX', 'BTC', '10Y'],
            refreshIntervalMs: 15 * 60 * 1000,
            version: '1.0'
        };

        const MARKET_DATA = {
            'ES':  { name: 'E-Mini S&P 500', price: 6048.25, change: 12.50, changePct: 0.21, high: 6055.00, low: 6030.75, decimals: 2 },
            'NQ':  { name: 'E-Mini Nasdaq', price: 21534.75, change: 89.25, changePct: 0.42, high: 21580.00, low: 21420.50, decimals: 2 },
            'SPY': { name: 'SPDR S&P 500', price: 604.52, change: 1.23, changePct: 0.20, high: 605.80, low: 602.10, decimals: 2 },
            'VIX': { name: 'CBOE Volatility', price: 15.42, change: -0.38, changePct: -2.40, high: 16.10, low: 15.20, decimals: 2 },
            'BTC': { name: 'Bitcoin USD', price: 97284.50, change: 1842.30, changePct: 1.93, high: 98100.00, low: 95200.00, decimals: 2 },
            '10Y': { name: '10Y Treasury', price: 4.485, change: -0.012, changePct: -0.27, high: 4.510, low: 4.470, decimals: 3 },
            // Watchlist stocks
            'AAPL': { name: 'Apple Inc', price: 234.56, change: -0.75, changePct: -0.32, high: 236.10, low: 233.80, decimals: 2 },
            'NVDA': { name: 'NVIDIA Corp', price: 138.25, change: 3.25, changePct: 2.41, high: 139.80, low: 135.20, decimals: 2 },
            'TSLA': { name: 'Tesla Inc', price: 352.80, change: 8.45, changePct: 2.45, high: 355.20, low: 344.10, decimals: 2 },
            'META': { name: 'Meta Platforms', price: 612.30, change: 4.80, changePct: 0.79, high: 615.00, low: 607.50, decimals: 2 },
            'AMZN': { name: 'Amazon.com', price: 225.40, change: -1.20, changePct: -0.53, high: 228.00, low: 224.10, decimals: 2 },
            'MSFT': { name: 'Microsoft Corp', price: 449.20, change: 2.30, changePct: 0.51, high: 451.50, low: 446.80, decimals: 2 },
            'GOOG': { name: 'Alphabet Inc', price: 178.90, change: 1.10, changePct: 0.62, high: 180.20, low: 177.50, decimals: 2 },
            'AMD':  { name: 'AMD Inc', price: 162.45, change: -2.10, changePct: -1.28, high: 165.00, low: 161.30, decimals: 2 },
            'NFLX': { name: 'Netflix Inc', price: 1048.50, change: 15.20, changePct: 1.47, high: 1052.00, low: 1030.00, decimals: 2 },
            'JPM':  { name: 'JPMorgan Chase', price: 268.75, change: 1.85, changePct: 0.69, high: 270.00, low: 266.50, decimals: 2 },
            'QQQ':  { name: 'Nasdaq 100 ETF', price: 527.84, change: 8.80, changePct: 1.69, high: 530.10, low: 519.40, decimals: 2 },
        };

        // Sparkline history (simulated)
        const SPARKLINE_DATA = {};
        function generateSparkline(symbol) {
            const data = MARKET_DATA[symbol];
            if (!data) return [];
            const bars = [];
            let val = data.price;
            for (let i = 0; i < 12; i++) {
                const delta = (Math.random() - 0.48) * data.price * 0.002;
                val += delta;
                bars.push({ value: Math.abs(delta), up: delta >= 0 });
            }
            return bars;
        }
        AXECAP_CONFIG.defaultTickers.forEach(s => { SPARKLINE_DATA[s] = generateSparkline(s); });

        let axecapWatchlist = [];
        let axecapRefreshTimer = null;
        let axecapCountdownSeconds = 15 * 60;

        const MARKET_NEWS = [
            { time: '09:45', headline: 'S&P 500 futures push higher as tech sector leads pre-market gains', source: 'Bloomberg', ticker: 'ES' },
            { time: '09:32', headline: 'NVIDIA announces next-gen Blackwell Ultra GPU architecture at GTC keynote', source: 'Reuters', ticker: 'NVDA' },
            { time: '09:18', headline: 'Bitcoin breaks through $97K resistance level on institutional buying pressure', source: 'CoinDesk', ticker: 'BTC' },
            { time: '09:05', headline: 'Fed minutes signal patience on rate cuts, treasury yields edge lower', source: 'CNBC', ticker: '10Y' },
            { time: '08:52', headline: 'Apple Vision Pro sales exceed Q2 estimates, services revenue hits record', source: 'Bloomberg', ticker: 'AAPL' },
            { time: '08:40', headline: 'Tesla Robotaxi program receives regulatory approval in three new states', source: 'Reuters', ticker: 'TSLA' },
            { time: '08:25', headline: 'VIX drops below 16 as market volatility continues to compress', source: 'MarketWatch', ticker: 'VIX' },
            { time: '08:10', headline: 'Meta reports strong ad revenue growth driven by AI-powered targeting', source: 'CNBC', ticker: 'META' },
            { time: '07:55', headline: 'Amazon Web Services announces major expansion in European data centers', source: 'TechCrunch', ticker: 'AMZN' },
            { time: '07:30', headline: 'Nasdaq futures indicate strong open as earnings season beats expectations', source: 'Bloomberg', ticker: 'NQ' }
        ];

        const FEED_ITEMS = [
            { time: '11:23 PM', agent: 'Anders', content: 'DB Tech OS v2.0 rebuilt from scratch — glassmorphism, animated gradients, command palette with fuzzy search, toast system, theme toggle. Deployed to Vercel.', tags: ['shipped', 'dbtech-os'], active: true },
            { time: '10:45 PM', agent: 'Milo', content: 'Overnight delivery sprint initiated. Coordinating all agents for maximum output. DB Tech OS rebuild is priority #1.', tags: ['coordination', 'sprint'] },
            { time: '9:30 PM', agent: 'Paula', content: 'Concrete Before Curtains brand identity complete. Logo, color palette, and landing page wireframes delivered to Anders.', tags: ['design', 'branding'] },
            { time: '8:15 PM', agent: 'Bobby', content: 'Evening market brief published. SPY holding above key support at 600. NVDA earnings setup looks strong — watching for breakout.', tags: ['markets', 'analysis'] },
            { time: '7:00 PM', agent: 'Dax', content: 'Signal & Noise Edition #47 drafted. Reviewing macro themes and sector rotation data for tomorrow\'s publish.', tags: ['content', 'newsletter'] },
            { time: '5:30 PM', agent: 'Remy', content: 'Sunday Squares social campaign assets completed. 12 templates ready for scheduling across platforms.', tags: ['marketing', 'design'] },
            { time: '4:00 PM', agent: 'Tony', content: 'Bobola\'s weekend prep checklist completed. Menu prices updated per Q1 review. New seasonal items added.', tags: ['operations', 'restaurant'] },
            { time: '2:00 PM', agent: 'Wendy', content: 'Soul Solace guided reflection module wireframed. 28 daily prompts for the month ready for review.', tags: ['wellness', 'content'] }
        ];

        const LINKS = {
            vercel: [
                { name: 'DB Tech OS', url: 'dbtech-os.vercel.app', icon: '⌘' },
                { name: 'dbtech45.com', url: 'dbtech45.com', icon: '🌐' },
                { name: 'Soul Solace', url: 'soul-solace.vercel.app', icon: '🧘' },
                { name: 'Signal & Noise', url: 'signal-noise.vercel.app', icon: '📰' },
                { name: 'Sunday Squares', url: 'sunday-squares.vercel.app', icon: '🟧' },
                { name: 'SharpEdge AI', url: 'sharpedge-ai.vercel.app', icon: '🤖' },
                { name: 'Boundless', url: 'boundless.vercel.app', icon: '✨' },
                { name: 'tickR', url: 'tickr-app.vercel.app', icon: '📈' },
                { name: 'Concrete Before Curtains', url: 'concrete-before-curtains.vercel.app', icon: '🧱' }
            ],
            github: [
                { name: '7LayerLabs (Org)', url: 'github.com/7LayerLabs', icon: '◆' },
                { name: 'dbtech45', url: 'github.com/7LayerLabs/dbtech45', icon: '🌐' },
                { name: 'SundaySquares', url: 'github.com/7LayerLabs/SundaySquares', icon: '🏈' },
                { name: 'Soulsolace', url: 'github.com/7LayerLabs/Soulsolace', icon: '🧘' },
                { name: 'boundless', url: 'github.com/7LayerLabs/boundless', icon: '✨' },
                { name: 'tickR', url: 'github.com/7LayerLabs/tickR', icon: '📈' },
                { name: 'menusparks', url: 'github.com/7LayerLabs/menusparks', icon: '🍽️' },
                { name: 'spendsignal', url: 'github.com/7LayerLabs/spendsignal', icon: '💰' },
                { name: 'Bobolas-site', url: 'github.com/7LayerLabs/Bobolas-site', icon: '🍕' },
                { name: 'picforge', url: 'github.com/7LayerLabs/picforge', icon: '🎨' },
                { name: 'backnine', url: 'github.com/7LayerLabs/backnine', icon: '⛳' },
                { name: 'inventorybuddy', url: 'github.com/7LayerLabs/inventorybuddy', icon: '📦' }
            ],
            telegram: [
                { name: 'Milo Bot', url: 't.me/MiloAssistBot', icon: '🧠' },
                { name: 'Bobby Bot', url: 't.me/BobbyMarketBot', icon: '📊' },
                { name: 'Anders Bot', url: 't.me/AndersDevBot', icon: '⚡' },
                { name: 'DBTech Hub', url: 't.me/dbtechhub', icon: '🏠' }
            ],
            tools: [
                { name: 'Vercel Dashboard', url: 'vercel.com/dbtech45', icon: '▲' },
                { name: 'GitHub Dashboard', url: 'github.com/dbtech45', icon: '◆' },
                { name: 'Cloudflare', url: 'dash.cloudflare.com', icon: '☁' },
                { name: 'Google Analytics', url: 'analytics.google.com', icon: '📊' },
                { name: 'Figma', url: 'figma.com', icon: '🎨' },
                { name: 'Claude', url: 'claude.ai', icon: '🤖' }
            ]
        };

        let ideas = [
            { id: 1, title: 'AI Recipe Generator', desc: 'Generate recipes based on available ingredients, dietary restrictions, and cuisine preferences. Could integrate with Bobola\'s menu.', status: 'researching', date: '2025-02-01' },
            { id: 2, title: 'Portfolio Tracker Dashboard', desc: 'Real-time portfolio tracking integrated with Bobby\'s analysis. Show P&L, allocations, and trade journal.', status: 'building', date: '2025-02-02' },
            { id: 3, title: 'Design System Marketplace', desc: 'Sell pre-built design systems and component libraries. Leverage Paula\'s design work.', status: 'new', date: '2025-02-03' },
            { id: 4, title: 'Micro-SaaS: Invoice Generator', desc: 'Simple, beautiful invoice generator for freelancers. Stripe integration for payments.', status: 'new', date: '2025-02-04' },
            { id: 5, title: 'AI Betting Model', desc: 'Machine learning model for sports predictions. Feed into SharpEdge AI for automated analysis.', status: 'researching', date: '2025-01-28' },
            { id: 6, title: 'Wellness NFT Collection', desc: 'Digital art collection tied to Soul Solace reflections. Each piece represents a mindfulness concept.', status: 'killed', date: '2025-01-15' }
        ];

        // Busy task variations for agent randomizer
        const BUSY_TASKS = [
            'Processing large dataset — ETA 12 minutes',
            'Running batch deployment across 3 services',
            'Deep analysis in progress — do not disturb',
            'Generating comprehensive report',
            'Training model on latest data batch',
            'Rebuilding search index — 78% complete',
            'Running automated test suite (847 tests)',
            'Compiling analytics digest for the week'
        ];

        // ─── AGENT STATUS RANDOMIZER ─────────────────

        function randomizeAgentStatuses() {
            // Reset all to online first
            AGENTS.forEach(a => { a.status = 'online'; });
            // Randomly pick 1-2 agents to be busy
            const count = Math.random() > 0.5 ? 2 : 1;
            const indices = [];
            while (indices.length < count) {
                const idx = Math.floor(Math.random() * AGENTS.length);
                if (!indices.includes(idx)) indices.push(idx);
            }
            indices.forEach(idx => {
                AGENTS[idx].status = 'busy';
                AGENTS[idx].task = BUSY_TASKS[Math.floor(Math.random() * BUSY_TASKS.length)];
            });
        }

        // ─── TOAST SYSTEM ────────────────────────────

        function showToast(title, message, type = 'accent') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            const icons = { accent: '⚡', success: '✓', warning: '⚠' };
            toast.innerHTML = `
                <span class="toast-icon">${icons[type] || '⚡'}</span>
                <div class="toast-body">
                    <div class="toast-title">${title}</div>
                    ${message ? `<div class="toast-message">${message}</div>` : ''}
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">✕</button>
            `;
            container.appendChild(toast);
            setTimeout(() => {
                toast.classList.add('removing');
                setTimeout(() => toast.remove(), 300);
            }, 3500);
        }

        // ─── ANIMATED COUNTERS ───────────────────────

        function animateCounters() {
            document.querySelectorAll('.stat-value[data-count]').forEach(el => {
                const target = parseInt(el.dataset.count);
                const duration = 1000;
                const start = performance.now();
                const initial = 0;

                function update(now) {
                    const elapsed = now - start;
                    const progress = Math.min(elapsed / duration, 1);
                    // Ease out cubic
                    const eased = 1 - Math.pow(1 - progress, 3);
                    el.textContent = Math.round(initial + (target - initial) * eased);
                    if (progress < 1) requestAnimationFrame(update);
                }
                requestAnimationFrame(update);
            });
        }

        // ─── THEME TOGGLE ────────────────────────────

        function initTheme() {
            const stored = localStorage.getItem('dbtech-os-theme');
            const theme = stored || 'dark';
            document.documentElement.setAttribute('data-theme', theme);
            updateThemeIcon(theme);
        }

        function toggleTheme() {
            const current = document.documentElement.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            document.documentElement.setAttribute('data-theme', next);
            localStorage.setItem('dbtech-os-theme', next);
            updateThemeIcon(next);
            showToast('Theme Updated', `Switched to ${next} mode`, 'accent');
        }

        function updateThemeIcon(theme) {
            document.getElementById('themeToggle').textContent = theme === 'dark' ? '☀' : '🌙';
        }

        document.getElementById('themeToggle').addEventListener('click', toggleTheme);

        // ─── CLOCK & GREETING ────────────────────────

        function updateClock() {
            const now = new Date();
            const time = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            const shortTime = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

            document.getElementById('sidebarTime').textContent = time;
            document.getElementById('topbarClock').textContent = shortTime;

            const hour = now.getHours();
            let greeting;
            if (hour < 5) greeting = 'Good night';
            else if (hour < 12) greeting = 'Good morning';
            else if (hour < 17) greeting = 'Good afternoon';
            else greeting = 'Good evening';

            document.getElementById('sidebarGreeting').innerHTML = `${greeting}, <strong>Derek</strong>`;
        }

        setInterval(updateClock, 1000);
        updateClock();

        // ─── RENDER FUNCTIONS ────────────────────────

        function renderAgents() {
            const grid = document.getElementById('agentsGrid');
            grid.innerHTML = AGENTS.map(agent => `
                <div class="agent-card" style="--agent-color: ${agent.color};">
                    <div class="agent-header">
                        <div class="agent-identity">
                            <div class="agent-avatar" style="background: ${agent.color};">
                                ${agent.emoji}
                                <div class="status-indicator" style="background: ${agent.status === 'online' ? 'var(--status-online)' : agent.status === 'busy' ? 'var(--status-busy)' : 'var(--status-offline)'}"></div>
                            </div>
                            <div>
                                <div class="agent-name">${agent.name}</div>
                                <div class="agent-role">${agent.role}</div>
                            </div>
                        </div>
                        <span class="badge badge-${agent.status}">
                            <span class="badge-dot"></span>
                            ${agent.status}
                        </span>
                    </div>
                    <div class="agent-body">
                        <div class="agent-task">
                            <span class="agent-task-icon">▸</span>
                            <span>${agent.task}</span>
                        </div>
                    </div>
                    <div class="agent-meta">
                        <span class="agent-last-active">${agent.lastActive}</span>
                        <button class="agent-action" onclick="messageAgent('${agent.name}')">Message →</button>
                    </div>
                </div>
            `).join('');
        }

        // ─── PROJECT PRIORITIES (localStorage) ──────
        let projectPriorities = {};
        try {
            const stored = localStorage.getItem('dbtech-project-priorities');
            if (stored) projectPriorities = JSON.parse(stored);
        } catch(e) {}

        function saveProjectPriorities() {
            localStorage.setItem('dbtech-project-priorities', JSON.stringify(projectPriorities));
        }

        function setProjectPriority(projectName, rating) {
            if (projectPriorities[projectName] === rating) {
                delete projectPriorities[projectName];
            } else {
                projectPriorities[projectName] = rating;
            }
            saveProjectPriorities();
            renderProjects(currentProjectFilter);
        }

        function sendToKanban(btn, projectName) {
            btn.classList.add('sent');
            btn.innerHTML = 'Sent to Kanban ✓';
            setTimeout(() => {
                btn.classList.remove('sent');
                btn.innerHTML = '▦ Send to Kanban';
            }, 2000);
        }

        let currentProjectFilter = 'all';
        let sortByPriority = false;

        function buildProjectFilterTabs() {
            const container = document.getElementById('projectFilters');
            const statusLabels = {
                'shipped': 'Shipped', 'building': 'Building', 'beta': 'Beta',
                'planning': 'Planning', 'shaping': 'Shaping', 'spark': 'Spark',
                'paused': 'Paused', 'killed': 'Killed'
            };
            const activeStatuses = [...new Set(PROJECTS.map(p => p.status))];
            const statusOrder = ['shipped', 'building', 'beta', 'planning', 'shaping', 'spark', 'paused', 'killed'];
            const orderedStatuses = statusOrder.filter(s => activeStatuses.includes(s));

            let html = '<button class="filter-btn ' + (currentProjectFilter === 'all' ? 'active' : '') + '" data-filter="all">All</button>';
            orderedStatuses.forEach(s => {
                html += '<button class="filter-btn ' + (currentProjectFilter === s ? 'active' : '') + '" data-filter="' + s + '">' + (statusLabels[s] || s) + '</button>';
            });
            html += '<button class="sort-priority-btn ' + (sortByPriority ? 'active' : '') + '" id="sortPriorityBtn">⭐ Sort by Priority</button>';
            container.innerHTML = html;

            container.querySelectorAll('[data-filter]').forEach(btn => {
                btn.addEventListener('click', () => {
                    container.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentProjectFilter = btn.dataset.filter;
                    renderProjects(currentProjectFilter);
                });
            });

            document.getElementById('sortPriorityBtn').addEventListener('click', () => {
                sortByPriority = !sortByPriority;
                document.getElementById('sortPriorityBtn').classList.toggle('active', sortByPriority);
                renderProjects(currentProjectFilter);
            });
        }

        function renderProjects(filter = 'all') {
            currentProjectFilter = filter;
            const grid = document.getElementById('projectsGrid');

            const statusMap = {
                'shipped': { label: 'Shipped', class: 'shipped' },
                'building': { label: 'Building', class: 'building' },
                'beta': { label: 'Beta', class: 'beta' },
                'planning': { label: 'Planning', class: 'planning' },
                'shaping': { label: 'Shaping', class: 'shaping' },
                'spark': { label: 'Spark', class: 'spark' },
                'paused': { label: 'Paused', class: 'paused' },
                'killed': { label: 'Killed', class: 'killed' },
                'active': { label: 'Building', class: 'building' },
                'launched': { label: 'Shipped', class: 'shipped' },
                'progress': { label: 'Building', class: 'building' }
            };

            let filtered = filter === 'all' ? [...PROJECTS] : PROJECTS.filter(p => p.status === filter);

            if (sortByPriority) {
                filtered.sort((a, b) => {
                    const pa = projectPriorities[a.name] || 0;
                    const pb = projectPriorities[b.name] || 0;
                    return pb - pa;
                });
            }

            grid.innerHTML = filtered.map(project => {
                const status = statusMap[project.status] || statusMap.building;
                const hasUrl = project.url && project.url !== '#';
                const isKilled = project.status === 'killed';
                const priority = projectPriorities[project.name] || 0;
                const escapedName = project.name.replace(/'/g, "\\'");

                const stars = [1,2,3,4,5].map(i =>
                    '<span class="star ' + (i <= priority ? 'filled' : '') + '"' +
                    ' onmouseenter="this.parentElement.querySelectorAll(\'.star\').forEach((s,idx) => { if(idx < ' + i + ') s.classList.add(\'hover\'); else s.classList.remove(\'hover\'); })"' +
                    ' onmouseleave="this.parentElement.querySelectorAll(\'.star\').forEach(s => s.classList.remove(\'hover\'))"' +
                    ' onclick="setProjectPriority(\'' + escapedName + '\', ' + i + ')">★</span>'
                ).join('');

                return `
                <div class="project-card ${isKilled ? 'killed' : ''}">
                    <div class="project-color-bar" style="background: ${project.color};"></div>
                    <div class="project-header">
                        <div class="project-name" style="color: ${project.color};">${project.name}</div>
                        <span class="badge badge-${status.class}">
                            <span class="badge-dot"></span>
                            ${status.label}
                        </span>
                    </div>
                    <div class="project-desc">${project.desc}</div>
                    <div class="star-rating">${stars}</div>
                    <div class="project-progress">
                        <div class="progress-bar-bg">
                            <div class="progress-bar-fill" style="width: ${project.progress}%; background: ${project.color};"></div>
                        </div>
                        <div class="progress-label">
                            <span>Progress</span>
                            <span>${project.progress}%</span>
                        </div>
                    </div>
                    <div class="project-links">
                        ${hasUrl ? `<a href="https://${project.url}" target="_blank" class="project-link">🌐 Live Site</a>` : ''}
                        ${project.repo ? `<a href="https://github.com/7LayerLabs/${project.repo}" target="_blank" class="project-link">◆ Repo</a>` : ''}
                        <span class="project-link" onclick="navigateTo('mission-control')">👥 Team</span>
                        <button class="kanban-btn" onclick="sendToKanban(this, '${escapedName}')">▦ Send to Kanban</button>
                    </div>
                </div>
            `}).join('');
        }

        // ─── AXECAP TERMINAL FUNCTIONS ──────────

        function formatPrice(price, decimals) {
            if (price >= 1000) return price.toLocaleString('en-US', { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
            return price.toFixed(decimals);
        }

        function renderTickerBoard() {
            const grid = document.getElementById('axecapTickerGrid');
            if (!grid) return;
            grid.innerHTML = AXECAP_CONFIG.defaultTickers.map(symbol => {
                const d = MARKET_DATA[symbol];
                if (!d) return '';
                const isUp = d.change >= 0;
                const arrow = isUp ? '▲' : '▼';
                const cls = isUp ? 'up' : 'down';
                const prefix = symbol === 'BTC' ? '$' : (symbol === '10Y' ? '' : (d.price > 100 ? '$' : '$'));
                const suffix = symbol === '10Y' ? '%' : '';
                const sparkBars = (SPARKLINE_DATA[symbol] || []).map(b => {
                    const h = Math.max(2, Math.min(18, (b.value / (d.price * 0.003)) * 18));
                    return `<div class="bar ${b.up ? 'up' : 'down'}" style="height:${h}px"></div>`;
                }).join('');
                return `<div class="ticker-cell">
                    <div class="ticker-symbol">${symbol}</div>
                    <div class="ticker-name">${d.name}</div>
                    <div class="ticker-price">${prefix}${formatPrice(d.price, d.decimals)}${suffix}</div>
                    <div class="ticker-change ${cls}">${arrow} ${isUp ? '+' : ''}${d.change.toFixed(d.decimals)} (${isUp ? '+' : ''}${d.changePct.toFixed(2)}%)</div>
                    <div class="ticker-sparkline">${sparkBars}</div>
                    <div class="ticker-range"><span>L: ${prefix}${formatPrice(d.low, d.decimals)}${suffix}</span><span>H: ${prefix}${formatPrice(d.high, d.decimals)}${suffix}</span></div>
                </div>`;
            }).join('');
        }

        function renderWatchlist() {
            const container = document.getElementById('axecapWatchlist');
            if (!container) return;
            if (axecapWatchlist.length === 0) {
                container.innerHTML = '<div class="watchlist-empty">No symbols in watchlist. Add one above.</div>';
                return;
            }
            let rows = axecapWatchlist.map(symbol => {
                const d = MARKET_DATA[symbol.toUpperCase()];
                if (!d) return `<tr><td class="wl-symbol">${symbol.toUpperCase()}</td><td colspan="3" style="color:#666;">No data</td><td><button class="watchlist-remove" onclick="removeFromWatchlist('${symbol}')">✕</button></td></tr>`;
                const isUp = d.change >= 0;
                const cls = isUp ? 'up' : 'down';
                const arrow = isUp ? '▲' : '▼';
                return `<tr>
                    <td class="wl-symbol">${symbol.toUpperCase()}</td>
                    <td style="color:#888;font-size:11px;">${d.name}</td>
                    <td class="wl-price">$${formatPrice(d.price, d.decimals)}</td>
                    <td class="ticker-change ${cls}">${arrow} ${isUp ? '+' : ''}${d.change.toFixed(d.decimals)} (${isUp ? '+' : ''}${d.changePct.toFixed(2)}%)</td>
                    <td style="text-align:right;"><button class="watchlist-remove" onclick="removeFromWatchlist('${symbol}')">✕</button></td>
                </tr>`;
            }).join('');
            container.innerHTML = `<table class="watchlist-table">
                <thead><tr><th>Symbol</th><th>Name</th><th>Price</th><th>Change</th><th></th></tr></thead>
                <tbody>${rows}</tbody>
            </table>`;
        }

        function renderNews() {
            const panel = document.getElementById('axecapNewsPanel');
            if (!panel) return;
            const today = new Date().toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            let html = '<div class="news-panel-header">⬡ Market Briefing</div>';
            html += MARKET_NEWS.map(n => `<div class="news-item">
                <div class="news-meta">
                    <span class="news-time">${n.time} ET · ${today}</span>
                </div>
                <div class="news-headline">${n.headline}</div>
                <div><span class="news-source">${n.source}</span><span class="news-ticker">${n.ticker}</span></div>
            </div>`).join('');
            panel.innerHTML = html;
        }

        function addToWatchlist(symbolOverride) {
            const input = document.getElementById('watchlistInput');
            const symbol = (symbolOverride || (input ? input.value : '')).trim().toUpperCase();
            if (!symbol) return;
            if (axecapWatchlist.includes(symbol)) {
                if (typeof showToast === 'function') showToast('Already in Watchlist', symbol + ' is already tracked', 'info');
                if (input) input.value = '';
                return;
            }
            // Generate simulated data for unknown symbols
            if (!MARKET_DATA[symbol]) {
                const fakePrice = Math.round((20 + Math.random() * 500) * 100) / 100;
                const fakeChange = Math.round((Math.random() - 0.45) * fakePrice * 0.03 * 100) / 100;
                MARKET_DATA[symbol] = {
                    name: symbol,
                    price: fakePrice,
                    change: fakeChange,
                    changePct: Math.round((fakeChange / fakePrice) * 10000) / 100,
                    high: Math.round((fakePrice * 1.01) * 100) / 100,
                    low: Math.round((fakePrice * 0.99) * 100) / 100,
                    decimals: 2
                };
            }
            axecapWatchlist.push(symbol);
            localStorage.setItem('axecap-watchlist', JSON.stringify(axecapWatchlist));
            if (input) input.value = '';
            renderWatchlist();
        }

        function removeFromWatchlist(symbol) {
            axecapWatchlist = axecapWatchlist.filter(s => s !== symbol.toUpperCase());
            localStorage.setItem('axecap-watchlist', JSON.stringify(axecapWatchlist));
            renderWatchlist();
        }

        function refreshMarketData() {
            // Simulate small price movements
            Object.keys(MARKET_DATA).forEach(symbol => {
                const d = MARKET_DATA[symbol];
                const volatility = symbol === 'BTC' ? 0.005 : (symbol === 'VIX' ? 0.008 : 0.002);
                const delta = (Math.random() - 0.48) * d.price * volatility;
                d.price = Math.round((d.price + delta) * Math.pow(10, d.decimals)) / Math.pow(10, d.decimals);
                d.change = Math.round((d.change + delta * 0.3) * Math.pow(10, d.decimals)) / Math.pow(10, d.decimals);
                d.changePct = Math.round((d.change / d.price) * 10000) / 100;
                d.high = Math.max(d.high, d.price);
                d.low = Math.min(d.low, d.price);
            });
            // Update sparklines
            AXECAP_CONFIG.defaultTickers.forEach(s => { SPARKLINE_DATA[s] = generateSparkline(s); });
            renderTickerBoard();
            renderWatchlist();
            updateStatusBar();
            axecapCountdownSeconds = 15 * 60;
        }

        function updateStatusBar() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
            const el = document.getElementById('axecapLastRefresh');
            if (el) el.textContent = 'Last refresh: ' + timeStr;
            const headerTime = document.getElementById('axecapHeaderTime');
            if (headerTime) headerTime.textContent = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }

        function updateCountdown() {
            axecapCountdownSeconds--;
            if (axecapCountdownSeconds <= 0) {
                refreshMarketData();
                return;
            }
            const mins = Math.floor(axecapCountdownSeconds / 60);
            const secs = axecapCountdownSeconds % 60;
            const el = document.getElementById('axecapNextRefresh');
            if (el) el.textContent = 'Next: ' + String(mins).padStart(2, '0') + ':' + String(secs).padStart(2, '0');
        }

        function startAutoRefresh() {
            if (axecapRefreshTimer) clearInterval(axecapRefreshTimer);
            axecapCountdownSeconds = 15 * 60;
            axecapRefreshTimer = setInterval(updateCountdown, 1000);
        }

        function initAxeCap() {
            // Load watchlist from localStorage
            try {
                const saved = localStorage.getItem('axecap-watchlist');
                axecapWatchlist = saved ? JSON.parse(saved) : ['AAPL', 'NVDA', 'TSLA', 'META', 'AMZN'];
            } catch(e) {
                axecapWatchlist = ['AAPL', 'NVDA', 'TSLA', 'META', 'AMZN'];
            }
            if (!localStorage.getItem('axecap-watchlist')) {
                localStorage.setItem('axecap-watchlist', JSON.stringify(axecapWatchlist));
            }
            renderTickerBoard();
            renderWatchlist();
            renderNews();
            updateStatusBar();
            startAutoRefresh();
        }

        function renderFeed() {
            const now = new Date();
            document.getElementById('feedDate').textContent = now.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            const briefTimeEl = document.getElementById('briefTime');
            if (briefTimeEl) briefTimeEl.textContent = now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });

            const timeline = document.getElementById('feedTimeline');
            timeline.innerHTML = FEED_ITEMS.map(item => `
                <div class="feed-item">
                    <div class="feed-dot ${item.active ? 'active' : ''}"></div>
                    <div class="feed-card">
                        <div class="feed-time">${item.time}</div>
                        <div class="feed-agent">${item.agent}</div>
                        <div class="feed-content">${item.content}</div>
                        <div class="feed-tags">
                            ${item.tags.map(tag => `<span class="feed-tag">${tag}</span>`).join('')}
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderLinks() {
            const renderSection = (containerId, items) => {
                const container = document.getElementById(containerId);
                container.innerHTML = items.map(link => `
                    <a href="https://${link.url}" target="_blank" class="link-card">
                        <div class="link-icon">${link.icon}</div>
                        <div class="link-info">
                            <div class="link-name">${link.name}</div>
                            <div class="link-url">${link.url}</div>
                        </div>
                        <span class="link-arrow">→</span>
                    </a>
                `).join('');
            };

            renderSection('vercelLinks', LINKS.vercel);
            renderSection('githubLinks', LINKS.github);
            renderSection('telegramLinks', LINKS.telegram);
            renderSection('toolLinks', LINKS.tools);
        }

        function renderIdeas(filter = 'all') {
            const grid = document.getElementById('ideasGrid');
            const filtered = filter === 'all' ? ideas : ideas.filter(i => i.status === filter);

            const statusEmoji = { 'new': '🆕', 'researching': '🔍', 'building': '🔨', 'launched': '🚀', 'killed': '💀' };
            const statusClass = { 'new': 'active', 'researching': 'progress', 'building': 'busy', 'launched': 'launched', 'killed': 'offline' };

            grid.innerHTML = filtered.map(idea => `
                <div class="idea-card" data-status="${idea.status}">
                    <div class="idea-header">
                        <div class="idea-title">${idea.title}</div>
                        <span class="badge badge-${statusClass[idea.status]}">
                            ${statusEmoji[idea.status]} ${idea.status}
                        </span>
                    </div>
                    <div class="idea-desc">${idea.desc}</div>
                    <div class="idea-meta">
                        <span>Added ${idea.date}</span>
                        <button class="agent-action" onclick="cycleIdeaStatus(${idea.id})">Cycle Status</button>
                    </div>
                </div>
            `).join('');

            const countEl = document.getElementById('ideasCount');
            countEl.textContent = ideas.length;
            countEl.dataset.count = ideas.length;
        }

        // ─── SKELETON LOADING ────────────────────────

        function showSkeletons() {
            const grid = document.getElementById('agentsGrid');
            grid.innerHTML = Array(9).fill('').map(() =>
                `<div class="agent-card"><div class="skeleton skeleton-card"></div></div>`
            ).join('');
        }

        // ─── NAVIGATION (HASH ROUTING) ──────────────

        const SECTION_NAMES = {
            'mission-control': 'Mission Control',
            'model-counsel': 'Model Counsel',
            'projects': 'Projects Board',
            'markets': 'AxeCap Terminal',
            'daily-feed': 'Daily Feed',
            'quick-links': 'Quick Links',
            'kanban': 'Kanban Board',
            'ideas-vault': 'Ideas Vault',
            'activity-dashboard': 'Activity Dashboard',
            'dna': 'DNA',
            'memory-bank': 'Memory Bank',
            'skills-inventory': 'Skills Inventory'
        };

        const BREADCRUMB_MAP = {
            'mission-control': 'Overview',
            'model-counsel': 'AI Comparison',
            'projects': 'All Projects',
            'markets': 'Market Intel',
            'daily-feed': 'Activity Log',
            'quick-links': 'Links & Tools',
            'kanban': 'Task Board',
            'ideas-vault': 'Idea Tracker',
            'activity-dashboard': 'Live Feed',
            'dna': 'Values & Principles',
            'memory-bank': 'Knowledge Base',
            'skills-inventory': 'Agent Capabilities'
        };

        // ═══ PIN GATE ═══════════════════════════════
        let pinBuffer = '';
        let opsUnlocked = false;
        const OPS_PIN = '0256';
        const OPS_SECTIONS = ['activity-dashboard', 'dna', 'memory-bank', 'skills-inventory'];
        let pendingOpsSection = null;

        function checkOpsAccess(section) {
            if (opsUnlocked) return true;
            pendingOpsSection = section;
            document.getElementById('pinOverlay').style.display = 'flex';
            pinBuffer = '';
            updatePinDots();
            document.getElementById('pinError').style.display = 'none';
            return false;
        }

        function pinInput(digit) {
            if (pinBuffer.length >= 4) return;
            pinBuffer += digit;
            updatePinDots();
            if (pinBuffer.length === 4) {
                setTimeout(function() {
                    if (pinBuffer === OPS_PIN) {
                        opsUnlocked = true;
                        document.getElementById('pinOverlay').style.display = 'none';
                        if (pendingOpsSection) navigateTo(pendingOpsSection);
                    } else {
                        document.getElementById('pinError').style.display = 'block';
                        document.querySelectorAll('.pin-dot').forEach(function(d) { d.classList.add('error'); });
                        setTimeout(function() {
                            pinBuffer = '';
                            updatePinDots();
                            document.querySelectorAll('.pin-dot').forEach(function(d) { d.classList.remove('error'); });
                            document.getElementById('pinError').style.display = 'none';
                        }, 1000);
                    }
                }, 200);
            }
        }

        function pinClear() { pinBuffer = ''; updatePinDots(); }
        function pinBackspace() { pinBuffer = pinBuffer.slice(0, -1); updatePinDots(); }
        function updatePinDots() {
            document.querySelectorAll('.pin-dot').forEach(function(dot, i) {
                dot.classList.toggle('filled', i < pinBuffer.length);
            });
        }

        // ═══ MEMORY BANK DATA ═══════════════════════
        const MEMORY_ENTRIES = [
            { date: '2026-02-10', title: 'DB Tech OS V3 Modules', tags: ['shipped', 'dbtech-os'], content: 'Deployed sidebar expansion with 7 new sections. Activity Dashboard, DNA, Memory Bank, Skills Inventory.' },
            { date: '2026-02-07', title: 'Signal & Noise Voice Guide', tags: ['newsletter', 'brand'], content: 'Tight, decisive, data-first. No fluff. Close with actionable move. Bobby handles market intel, Dax handles data synthesis.' },
            { date: '2026-02-06', title: 'Agent Fleet Protocol Update', tags: ['ops', 'agents'], content: 'New QA checks for deploys, clearer escalation tags. Communication protocol established for agent-to-agent handoffs.' },
            { date: '2026-02-05', title: 'Boundless V2 Onboarding', tags: ['product', 'boundless'], content: 'Simplify to three screens. Lead with identity, then habit trigger. Paula delivering design by EOW.' },
            { date: '2026-02-04', title: 'SharpEdge AI Landing Page', tags: ['shipped', 'sharpedge'], content: 'Landing page deployed to Vercel. Next.js + Tailwind. Conversion-focused with clear CTAs.' },
            { date: '2026-02-03', title: 'X/Twitter Trends Monitor', tags: ['research', 'social'], content: 'Set up automated tech trends scanning. Tracking AI, coding tools, and developer ecosystem.' },
            { date: '2026-02-02', title: 'Sunday Squares Status', tags: ['product', 'sunday-squares'], content: 'Nearly done. Payment integration pending. Core game mechanics complete.' },
            { date: '2026-02-01', title: 'MenuSparks Client Feedback', tags: ['client', 'menusparks'], content: 'Focus on menu optimization dashboards, weekly snapshots, and SMS alerts. Clients want simpler UX.' },
            { date: '2026-01-31', title: 'Soul Solace Architecture', tags: ['product', 'soulsolace'], content: 'V2 spec finalized. Guided reflections, journaling, daily calm. InstantDB for real-time sync.' },
            { date: '2026-01-30', title: 'Pour Plan Concept', tags: ['spark', 'pourplan'], content: 'Drink recipe and bar management app. Basic scaffolding started.' },
            { date: '2026-01-29', title: 'Ticker App Research', tags: ['research', 'tickr'], content: 'Kids investing app concept. Teaching next generation about markets. Gamified learning approach.' },
            { date: '2026-01-28', title: 'Brand System Established', tags: ['brand', 'design'], content: 'Amber (#F59E0B) as primary accent. Dark theme standard. Space Grotesk + Inter + JetBrains Mono typography stack.' }
        ];

        function renderMemoryTimeline(filter) {
            filter = filter || '';
            var timeline = document.getElementById('memoryTimeline');
            if (!timeline) return;
            var filtered = filter ? MEMORY_ENTRIES.filter(function(e) {
                return e.title.toLowerCase().indexOf(filter.toLowerCase()) > -1 || 
                    e.content.toLowerCase().indexOf(filter.toLowerCase()) > -1 ||
                    e.tags.some(function(t) { return t.toLowerCase().indexOf(filter.toLowerCase()) > -1; });
            }) : MEMORY_ENTRIES;
            timeline.innerHTML = filtered.map(function(entry, i) {
                return '<div class="n8n-node memory-node ' + (i === 0 ? 'latest' : '') + '" style="margin-bottom:12px;" onclick="toggleMemoryExpand(this)">' +
                    '<div class="n8n-connector left active"></div>' +
                    '<div class="n8n-node-header">' +
                        '<div class="n8n-node-icon" style="background:rgba(245,158,11,0.1);color:#F59E0B;">⬡</div>' +
                        '<div style="flex:1;">' +
                            '<div class="n8n-node-title">' + entry.title + '</div>' +
                            '<div class="n8n-node-subtitle">' + entry.date + '</div>' +
                        '</div>' +
                        '<svg class="memory-chevron" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="#666" stroke-width="2" style="transition:transform 0.2s;flex-shrink:0;"><polyline points="6 9 12 15 18 9"/></svg>' +
                    '</div>' +
                    '<div class="n8n-node-body memory-body" style="display:none;border-top:1px solid #1A1A1A;">' +
                        '<p style="font-size:13px;color:#aaa;line-height:1.6;margin-bottom:10px;">' + entry.content + '</p>' +
                        '<div style="display:flex;gap:6px;flex-wrap:wrap;">' +
                            entry.tags.map(function(t) { return '<span class="n8n-badge">' + t + '</span>'; }).join('') +
                        '</div>' +
                    '</div>' +
                '</div>';
            }).join('');
            var badge = document.querySelector('#section-memory-bank .n8n-badge');
            if (badge) badge.textContent = filtered.length + ' entries';
        }
        function toggleMemoryExpand(node) {
            var body = node.querySelector('.memory-body');
            var chevron = node.querySelector('.memory-chevron');
            var isOpen = body.style.display !== 'none';
            body.style.display = isOpen ? 'none' : 'block';
            chevron.style.transform = isOpen ? 'rotate(0deg)' : 'rotate(180deg)';
        }
        function filterMemories(val) { renderMemoryTimeline(val); }

        // ═══ ACTIVITY STREAM DATA ═══════════════════
        const ACTIVITY_FEED = [
            { time: '5:02 PM', type: 'deploy', agent: 'Anders', msg: 'AxeCap Terminal deployed to production', icon: '▲', color: '#10B981' },
            { time: '4:45 PM', type: 'commit', agent: 'Anders', msg: 'feat: port projects enhancements to static OS page', icon: '◆', color: '#F59E0B' },
            { time: '4:30 PM', type: 'commit', agent: 'Anders', msg: 'feat: sidebar avatar + roundtable collapse/expand', icon: '◆', color: '#F59E0B' },
            { time: '3:15 PM', type: 'session', agent: 'Paula', msg: 'Brand Kit explorations — AxeCap Terminal wireframes', icon: '✦', color: '#EC4899' },
            { time: '2:00 PM', type: 'deploy', agent: 'Anders', msg: 'Model Counsel collapse/expand deployed', icon: '▲', color: '#10B981' },
            { time: '12:30 PM', type: 'session', agent: 'Milo', msg: 'Sprint coordination — prioritized Operations overhaul', icon: '⚡', color: '#A855F7' },
            { time: '11:00 AM', type: 'commit', agent: 'Anders', msg: 'fix: Brand Kit + Brand Spec as native pages', icon: '◆', color: '#F59E0B' },
            { time: '9:30 AM', type: 'session', agent: 'Bobby', msg: 'Morning market brief — ES holding above 6040 support', icon: '📊', color: '#EF4444' },
            { time: '8:00 AM', type: 'cron', agent: 'Milo', msg: 'Daily briefing delivered to Derek via Telegram', icon: '⏰', color: '#3B82F6' },
            { time: '7:00 AM', type: 'cron', agent: 'System', msg: 'All 6 cron jobs executed successfully', icon: '⚙', color: '#666' }
        ];
        function renderActivityStream() {
            var stream = document.getElementById('activityStream');
            if (!stream) return;
            stream.innerHTML = ACTIVITY_FEED.map(function(item) {
                return '<div style="display:flex;align-items:flex-start;gap:12px;padding:10px 0;border-bottom:1px solid #1A1A1A;">' +
                    '<div style="width:28px;height:28px;border-radius:6px;background:' + item.color + '15;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0;color:' + item.color + ';">' + item.icon + '</div>' +
                    '<div style="flex:1;min-width:0;">' +
                        '<div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">' +
                            '<span style="font-size:12px;font-weight:600;color:' + item.color + ';">' + item.agent + '</span>' +
                            '<span class="n8n-badge">' + item.type + '</span>' +
                            '<span style="font-family:JetBrains Mono,monospace;font-size:10px;color:#666;margin-left:auto;">' + item.time + '</span>' +
                        '</div>' +
                        '<div style="font-size:12px;color:#aaa;line-height:1.5;">' + item.msg + '</div>' +
                    '</div>' +
                '</div>';
            }).join('');
        }

        // ═══ SKILLS INVENTORY DATA ═══════════════════
        const AGENT_SKILLS = [
            { name: 'Milo', role: 'Chief of Staff', color: '#A855F7', icon: '⚡', skills: ['Coordination', 'Strategy', 'Task Routing', 'Sprint Planning', 'Daily Briefings'] },
            { name: 'Anders', role: 'Full Stack Architect', color: '#F97316', icon: 'AN', skills: ['React/Next.js', 'Node.js/APIs', 'Supabase', 'Vercel Deploy', 'Python'] },
            { name: 'Paula', role: 'Creative Director', color: '#EC4899', icon: '✦', skills: ['UI/UX Design', 'Brand Identity', 'Figma', 'Design Systems', 'Color Theory'] },
            { name: 'Bobby', role: 'Trading Analyst', color: '#EF4444', icon: 'AX', skills: ['Market Analysis', 'Options Flow', 'Technical Charts', 'Risk Assessment', 'Trade Journaling'] },
            { name: 'Dwight', role: 'Intelligence Officer', color: '#3B82F6', icon: 'DW', skills: ['Model Evaluation', 'Resource Allocation', 'Benchmarking', 'Performance Testing', 'Cost Analysis'] },
            { name: 'Dax', role: 'Data Scientist', color: '#06B6D4', icon: 'DX', skills: ['Data Analysis', 'Visualization', 'Newsletter Writing', 'Signal Processing', 'Trend Detection'] },
            { name: 'Tony', role: 'Restaurant Ops', color: '#EAB308', icon: 'TN', skills: ['Menu Optimization', 'Inventory', 'Scheduling', 'Cost Control', 'Vendor Management'] },
            { name: 'Remy', role: 'Marketing', color: '#22C55E', icon: 'RM', skills: ['Social Media', 'Content Strategy', 'Copywriting', 'Campaign Management', 'Analytics'] },
            { name: 'Wendy', role: 'Psychology', color: '#8B5CF6', icon: 'WR', skills: ['Behavioral Analysis', 'User Research', 'Habit Design', 'Wellness Content', 'Mindfulness'] }
        ];
        function renderAgentSkills() {
            var grid = document.getElementById('agentSkillsGrid');
            if (!grid) return;
            grid.innerHTML = AGENT_SKILLS.map(function(agent) {
                return '<div class="n8n-node">' +
                    '<div class="n8n-connector right active"></div>' +
                    '<div class="n8n-node-header">' +
                        '<div class="n8n-node-icon" style="background:' + agent.color + '20;color:' + agent.color + ';">' + agent.icon + '</div>' +
                        '<div>' +
                            '<div class="n8n-node-title">' + agent.name + '</div>' +
                            '<div class="n8n-node-subtitle">' + agent.role + '</div>' +
                        '</div>' +
                    '</div>' +
                    '<div class="n8n-node-body">' +
                        '<div style="display:flex;flex-wrap:wrap;gap:6px;">' +
                            agent.skills.map(function(s) { return '<span style="font-size:11px;padding:3px 8px;border-radius:4px;background:' + agent.color + '10;color:' + agent.color + ';border:1px solid ' + agent.color + '20;">' + s + '</span>'; }).join('') +
                        '</div>' +
                    '</div>' +
                '</div>';
            }).join('');
        }

        // ═══ DNA DATA ═══════════════════════════════
        const DNA_BRANCHES = [
            { title: 'Core Values', icon: '⎈', color: '#F59E0B', items: [
                { name: 'Build foundations first', desc: 'Prioritize systems, compounding leverage, and long-term resiliency.' },
                { name: 'Clarity beats speed', desc: 'Make the plan simple enough to execute under pressure.' },
                { name: 'Integrity in every rep', desc: 'Win the moment without sacrificing the mission.' }
            ]},
            { title: 'Operating Principles', icon: '◈', color: '#3B82F6', items: [
                { name: 'Default to action', desc: 'Move with velocity, then refine with feedback loops.' },
                { name: 'Design for repeatability', desc: 'Every workflow should be teachable and scalable.' },
                { name: 'Signal over noise', desc: 'Protect focus. Say no to shiny distractions.' }
            ]},
            { title: 'Decision Filters', icon: '⧉', color: '#10B981', items: [
                { name: 'Does it compound?', desc: 'Will this create leverage or reduce future friction?' },
                { name: 'Does it protect the brand?', desc: 'Everything ships with the DB Tech standard.' },
                { name: 'Does it energize the team?', desc: 'Momentum matters more than perfection.' }
            ]},
            { title: 'Anti-Patterns', icon: '⊘', color: '#EF4444', items: [
                { name: 'No vanity metrics', desc: "If it doesn't move revenue or retention, skip it." },
                { name: 'No premature optimization', desc: 'Ship it, validate it, then polish it.' },
                { name: 'No single points of failure', desc: 'Systems > heroes. Document everything.' }
            ]}
        ];
        function renderDNA() {
            var grid = document.getElementById('dnaGrid');
            if (!grid) return;
            grid.innerHTML = DNA_BRANCHES.map(function(branch) {
                return '<div class="n8n-node">' +
                    '<div class="n8n-connector left active"></div>' +
                    '<div class="n8n-node-header">' +
                        '<div class="n8n-node-icon" style="background:' + branch.color + '20;color:' + branch.color + ';">' + branch.icon + '</div>' +
                        '<div class="n8n-node-title">' + branch.title + '</div>' +
                    '</div>' +
                    '<div class="n8n-node-body">' +
                        branch.items.map(function(item) {
                            return '<div style="padding:8px 0;border-bottom:1px solid #1A1A1A;">' +
                                '<div style="font-size:13px;font-weight:600;color:#fff;margin-bottom:2px;">' + item.name + '</div>' +
                                '<div style="font-size:11px;color:#888;line-height:1.5;">' + item.desc + '</div>' +
                            '</div>';
                        }).join('') +
                    '</div>' +
                '</div>';
            }).join('');
        }

        function navigateTo(sectionId, updateHash = true) {
            if (OPS_SECTIONS.includes(sectionId) && !checkOpsAccess(sectionId)) return;
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.toggle('active', item.dataset.section === sectionId);
            });
            document.querySelectorAll('.section').forEach(section => {
                section.classList.toggle('active', section.id === `section-${sectionId}`);
            });
            document.getElementById('topbarTitle').textContent = SECTION_NAMES[sectionId] || sectionId;
            document.getElementById('topbarBreadcrumb').textContent = BREADCRUMB_MAP[sectionId] || '';

            if (updateHash) {
                history.pushState(null, '', `#${sectionId}`);
            }

            closeMobileSidebar();
        }

        function handleHashRoute() {
            const hash = location.hash.slice(1);
            if (hash && SECTION_NAMES[hash]) {
                navigateTo(hash, false);
            }
        }

        window.addEventListener('hashchange', handleHashRoute);
        window.addEventListener('popstate', handleHashRoute);

        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => navigateTo(item.dataset.section));
        });

        // ─── INTERACTIONS ────────────────────────────

        function messageAgent(name) {
            showToast(`→ ${name}`, 'Opening Telegram chat...', 'accent');
        }

        function refreshDashboard() {
            const btn = document.getElementById('refreshBtn');
            btn.textContent = '↻ Refreshing...';
            btn.disabled = true;
            showSkeletons();

            setTimeout(() => {
                randomizeAgentStatuses();
                renderAgents();
                renderProjects();
                initAxeCap();
                renderFeed();
                animateCounters();
                btn.textContent = '↻ Refresh';
                btn.disabled = false;
                showToast('Dashboard Refreshed', 'All data updated', 'success');
            }, 900);
        }

        // ─── KANBAN BOARD ─────────────────────────

        const KANBAN_SEED = [
            { id: 1, title: 'Launch Sunday Squares', desc: 'Finalize MVP and push to production', column: 'backlog', priority: 'high', date: '2025-01-15' },
            { id: 2, title: 'Boundless v2 design review', desc: 'Review new UI mockups with team', column: 'progress', priority: 'med', date: '2025-01-14' },
            { id: 3, title: 'Soul Solace beta testing', desc: 'Gather feedback from beta users', column: 'review', priority: 'med', date: '2025-01-13' },
            { id: 4, title: 'dbtech45.com terminal theme', desc: 'Ship the terminal-inspired landing page', column: 'done', priority: 'high', date: '2025-01-12' }
        ];

        let kanbanCards = [];
        let draggingCardId = null;

        function loadKanban() {
            try {
                const stored = localStorage.getItem('dbtech-kanban');
                if (stored) {
                    kanbanCards = JSON.parse(stored);
                } else {
                    kanbanCards = [...KANBAN_SEED];
                    saveKanban();
                }
            } catch(e) {
                kanbanCards = [...KANBAN_SEED];
            }
        }

        function saveKanban() {
            try { localStorage.setItem('dbtech-kanban', JSON.stringify(kanbanCards)); } catch(e) {}
        }

        function renderKanban() {
            const columns = ['backlog', 'progress', 'review', 'done'];
            columns.forEach(col => {
                const body = document.getElementById(`col-${col}`);
                const count = document.getElementById(`count-${col}`);
                const cards = kanbanCards.filter(c => c.column === col);
                count.textContent = cards.length;

                if (cards.length === 0) {
                    body.innerHTML = '<div class="kanban-empty">Drop cards here</div>';
                    return;
                }

                body.innerHTML = cards.map(card => `
                    <div class="kanban-card" draggable="true" data-card-id="${card.id}"
                         ondragstart="kanbanDragStart(event, ${card.id})"
                         ondragend="kanbanDragEnd(event)">
                        <div class="kanban-card-header">
                            <span class="kanban-card-title">${escapeHTML(card.title)}</span>
                            <button class="kanban-card-delete" onclick="deleteKanbanCard(${card.id})" title="Delete card">✕</button>
                        </div>
                        ${card.desc ? `<div class="kanban-card-desc">${escapeHTML(card.desc)}</div>` : ''}
                        <div class="kanban-card-meta">
                            <span class="kanban-priority ${card.priority}">${card.priority}</span>
                            <span class="kanban-card-date">${card.date}</span>
                        </div>
                    </div>
                `).join('');
            });
        }

        function escapeHTML(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        function kanbanDragStart(e, cardId) {
            draggingCardId = cardId;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', cardId);
        }

        function kanbanDragEnd(e) {
            e.target.classList.remove('dragging');
            draggingCardId = null;
            document.querySelectorAll('.kanban-column').forEach(col => col.classList.remove('drag-over'));
        }

        function kanbanDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
            const col = e.target.closest('.kanban-column');
            if (col) col.classList.add('drag-over');
        }

        function kanbanDragLeave(e) {
            const col = e.target.closest('.kanban-column');
            if (col && !col.contains(e.relatedTarget)) {
                col.classList.remove('drag-over');
            }
        }

        function kanbanDrop(e) {
            e.preventDefault();
            const col = e.target.closest('.kanban-column');
            if (!col) return;
            col.classList.remove('drag-over');

            const cardId = parseInt(e.dataTransfer.getData('text/plain'));
            const newColumn = col.dataset.column;
            const card = kanbanCards.find(c => c.id === cardId);
            if (card && card.column !== newColumn) {
                card.column = newColumn;
                saveKanban();
                renderKanban();
                showToast('Card Moved', `"${card.title}" → ${newColumn === 'progress' ? 'In Progress' : newColumn.charAt(0).toUpperCase() + newColumn.slice(1)}`, 'accent');
            }
        }

        function openKanbanModal() {
            document.getElementById('kanbanModal').classList.add('active');
            setTimeout(() => document.getElementById('kanbanTitle').focus(), 100);
        }

        function closeKanbanModal() {
            document.getElementById('kanbanModal').classList.remove('active');
            document.getElementById('kanbanTitle').value = '';
            document.getElementById('kanbanDesc').value = '';
            document.getElementById('kanbanColumn').value = 'backlog';
            document.getElementById('kanbanPriority').value = 'med';
        }

        function saveKanbanCard() {
            const title = document.getElementById('kanbanTitle').value.trim();
            const desc = document.getElementById('kanbanDesc').value.trim();
            const column = document.getElementById('kanbanColumn').value;
            const priority = document.getElementById('kanbanPriority').value;

            if (!title) {
                showToast('Missing Title', 'Give your card a name', 'warning');
                return;
            }

            kanbanCards.push({
                id: Date.now(),
                title,
                desc,
                column,
                priority,
                date: new Date().toISOString().split('T')[0]
            });

            saveKanban();
            renderKanban();
            closeKanbanModal();
            showToast('Card Added', `"${title}" added to board`, 'success');
        }

        function deleteKanbanCard(id) {
            const card = kanbanCards.find(c => c.id === id);
            kanbanCards = kanbanCards.filter(c => c.id !== id);
            saveKanban();
            renderKanban();
            if (card) showToast('Card Deleted', `"${card.title}" removed`, 'warning');
        }

        function openNewIdea() {
            document.getElementById('ideaModal').classList.add('active');
            setTimeout(() => document.getElementById('ideaTitle').focus(), 100);
        }

        function closeNewIdea() {
            document.getElementById('ideaModal').classList.remove('active');
            document.getElementById('ideaTitle').value = '';
            document.getElementById('ideaDesc').value = '';
            document.getElementById('ideaStatus').value = 'new';
        }

        function saveIdea() {
            const title = document.getElementById('ideaTitle').value.trim();
            const desc = document.getElementById('ideaDesc').value.trim();
            const status = document.getElementById('ideaStatus').value;

            if (!title) {
                showToast('Missing Title', 'Give your idea a name', 'warning');
                return;
            }

            const newIdea = {
                id: Date.now(),
                title,
                desc: desc || 'No description yet.',
                status,
                date: new Date().toISOString().split('T')[0]
            };

            ideas.unshift(newIdea);
            saveIdeasToStorage();
            renderIdeas();
            closeNewIdea();
            showToast('Idea Saved', `"${title}" added to vault`, 'success');
        }

        function cycleIdeaStatus(id) {
            const statuses = ['new', 'researching', 'building', 'launched', 'killed'];
            const idea = ideas.find(i => i.id === id);
            if (!idea) return;
            const currentIdx = statuses.indexOf(idea.status);
            idea.status = statuses[(currentIdx + 1) % statuses.length];
            saveIdeasToStorage();
            renderIdeas();
            showToast('Status Updated', `"${idea.title}" → ${idea.status}`, 'accent');
        }

        function saveIdeasToStorage() {
            try { localStorage.setItem('dbtech-os-ideas', JSON.stringify(ideas)); } catch(e) {}
        }

        function loadIdeasFromStorage() {
            try {
                const stored = localStorage.getItem('dbtech-os-ideas');
                if (stored) ideas = JSON.parse(stored);
            } catch(e) {}
        }

        // ─── FILTERS ────────────────────────────────

        buildProjectFilterTabs();

        document.querySelectorAll('[data-idea-filter]').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('[data-idea-filter]').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                renderIdeas(btn.dataset.ideaFilter);
            });
        });

        // ─── COMMAND PALETTE (FUZZY + KEYBOARD NAV) ──

        const commands = [
            { icon: '⌘', text: 'Mission Control', hint: 'Overview', kbd: '1', action: () => navigateTo('mission-control') },
            { icon: '⚡', text: 'Model Counsel', hint: 'AI comparison', kbd: 'M', action: () => navigateTo('model-counsel') },
            { icon: '◆', text: 'Projects Board', hint: 'All projects', kbd: '2', action: () => navigateTo('projects') },
            { icon: '◈', text: 'Market Dashboard', hint: 'Bobby\'s intel', kbd: '3', action: () => navigateTo('markets') },
            { icon: '▸', text: 'Daily Feed', hint: 'Today\'s activity', kbd: '4', action: () => navigateTo('daily-feed') },
            { icon: '↗', text: 'Quick Links', hint: 'All links', kbd: '5', action: () => navigateTo('quick-links') },
            { icon: '▦', text: 'Kanban Board', hint: 'Task board', kbd: '6', action: () => navigateTo('kanban') },
            { icon: '✦', text: 'Ideas Vault', hint: 'Track ideas', kbd: '7', action: () => navigateTo('ideas-vault') },
            { icon: '+', text: 'New Kanban Card', hint: 'Add to board', kbd: '', action: () => { navigateTo('kanban'); setTimeout(openKanbanModal, 300); } },
            { icon: '+', text: 'New Idea', hint: 'Add to vault', kbd: 'N', action: () => { navigateTo('ideas-vault'); setTimeout(openNewIdea, 300); } },
            { icon: '☀', text: 'Toggle Theme', hint: 'Light / Dark', kbd: '', action: toggleTheme },
            { icon: '↻', text: 'Refresh Dashboard', hint: 'Reload all data', kbd: '', action: refreshDashboard },
        ];

        let selectedCommandIndex = 0;
        let filteredCommands = [...commands];

        function fuzzyMatch(str, query) {
            const s = str.toLowerCase();
            const q = query.toLowerCase();
            let si = 0;
            for (let qi = 0; qi < q.length; qi++) {
                const found = s.indexOf(q[qi], si);
                if (found === -1) return false;
                si = found + 1;
            }
            return true;
        }

        function openCommandPalette() {
            document.getElementById('commandPalette').classList.add('active');
            const input = document.getElementById('commandInput');
            input.value = '';
            input.focus();
            selectedCommandIndex = 0;
            filteredCommands = [...commands];
            renderCommandResults();
        }

        function closeCommandPalette() {
            document.getElementById('commandPalette').classList.remove('active');
        }

        function renderCommandResults() {
            const results = document.getElementById('commandResults');
            results.innerHTML = filteredCommands.map((cmd, i) => `
                <div class="command-item ${i === selectedCommandIndex ? 'selected' : ''}" data-cmd-idx="${i}" onmouseenter="selectedCommandIndex=${i};renderCommandResults()" onclick="executeFilteredCommand(${i})">
                    <div class="command-item-icon">${cmd.icon}</div>
                    <span class="command-item-text">${cmd.text}</span>
                    <span class="command-item-hint">${cmd.hint}</span>
                    ${cmd.kbd ? `<span class="command-item-kbd">${cmd.kbd}</span>` : ''}
                </div>
            `).join('');
        }

        function executeFilteredCommand(idx) {
            if (filteredCommands[idx]) {
                filteredCommands[idx].action();
                closeCommandPalette();
            }
        }

        document.getElementById('commandInput').addEventListener('input', (e) => {
            const query = e.target.value.trim();
            filteredCommands = query
                ? commands.filter(c => fuzzyMatch(c.text, query) || fuzzyMatch(c.hint, query))
                : [...commands];
            selectedCommandIndex = 0;
            renderCommandResults();
        });

        document.getElementById('commandInput').addEventListener('keydown', (e) => {
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                selectedCommandIndex = Math.min(selectedCommandIndex + 1, filteredCommands.length - 1);
                renderCommandResults();
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                selectedCommandIndex = Math.max(selectedCommandIndex - 1, 0);
                renderCommandResults();
            } else if (e.key === 'Enter') {
                e.preventDefault();
                executeFilteredCommand(selectedCommandIndex);
            } else if (e.key === 'Escape') {
                closeCommandPalette();
            }
        });

        document.getElementById('commandPalette').addEventListener('click', (e) => {
            if (e.target.id === 'commandPalette') closeCommandPalette();
        });

        // ─── KEYBOARD SHORTCUTS ──────────────────────

        const sectionKeys = ['1', '2', '3', '4', '5', '6', '7'];
        const sectionIds = ['mission-control', 'projects', 'markets', 'daily-feed', 'quick-links', 'kanban', 'ideas-vault'];

        document.addEventListener('keydown', (e) => {
            // Don't fire shortcuts when typing in inputs
            const tag = e.target.tagName;
            const isInput = tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT';

            if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
                e.preventDefault();
                openCommandPalette();
                return;
            }

            if (e.key === 'Escape') {
                closeCommandPalette();
                closeNewIdea();
                closeKanbanModal();
                return;
            }

            if (isInput) return;

            // Number keys for sections
            const sectionIndex = sectionKeys.indexOf(e.key);
            if (sectionIndex !== -1) {
                e.preventDefault();
                navigateTo(sectionIds[sectionIndex]);
                return;
            }

            // N for new idea
            if (e.key === 'n' || e.key === 'N') {
                e.preventDefault();
                navigateTo('ideas-vault');
                setTimeout(openNewIdea, 300);
                return;
            }
        });

        // Search input click opens command palette
        document.getElementById('topbarSearchBtn').addEventListener('click', () => openCommandPalette());
        document.getElementById('searchInput').addEventListener('focus', (e) => {
            e.target.blur();
            openCommandPalette();
        });

        // Close modal on overlay click
        document.getElementById('ideaModal').addEventListener('click', (e) => {
            if (e.target.id === 'ideaModal') closeNewIdea();
        });

        document.getElementById('kanbanModal').addEventListener('click', (e) => {
            if (e.target.id === 'kanbanModal') closeKanbanModal();
        });

        // ─── MOBILE ──────────────────────────────────

        function closeMobileSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('sidebarBackdrop').classList.remove('active');
        }

        document.getElementById('mobileMenuBtn').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebarBackdrop').classList.toggle('active');
        });

        document.getElementById('sidebarBackdrop').addEventListener('click', closeMobileSidebar);

        // ─── INIT ────────────────────────────────────

        initTheme();
        loadKanban();
        loadIdeasFromStorage();
        randomizeAgentStatuses();
        renderAgents();
        renderProjects();
        initAxeCap();
        renderFeed();
        renderLinks();
        renderKanban();
        renderIdeas();
        renderMemoryTimeline();
        renderActivityStream();
        renderAgentSkills();
        renderDNA();
        handleHashRoute();

        // Animate counters after a brief delay
        setTimeout(animateCounters, 200);

        // Welcome toast on first visit
        if (!sessionStorage.getItem('dbtech-os-welcomed')) {
            setTimeout(() => {
                showToast('Welcome back, Derek', 'DB Tech OS is online. All systems operational.', 'accent');
                sessionStorage.setItem('dbtech-os-welcomed', '1');
            }, 800);
        }

        // ═══ MODEL COUNSEL ═══════════════════════════
        
        // Character counter for question textarea
        const counselQuestion = document.getElementById('counselQuestion');
        const charCount = document.getElementById('charCount');
        
        if (counselQuestion && charCount) {
            counselQuestion.addEventListener('input', () => {
                const len = counselQuestion.value.length;
                charCount.textContent = `${len} / 2000`;
                if (len > 2000) {
                    counselQuestion.value = counselQuestion.value.substring(0, 2000);
                    charCount.textContent = '2000 / 2000';
                }
            });
        }

        async function askModels() {
            const question = document.getElementById('counselQuestion').value.trim();
            if (!question) {
                showToast('Missing Question', 'Please enter a question to ask the models.', 'warning');
                return;
            }

            // Get selected models
            const checkboxes = document.querySelectorAll('#modelSelection input[type="checkbox"]:checked');
            const selectedModels = Array.from(checkboxes).map(cb => cb.value);

            if (selectedModels.length === 0) {
                showToast('No Models Selected', 'Please select at least one model to query.', 'warning');
                return;
            }

            // Show loading state
            document.getElementById('counselLoading').style.display = 'flex';
            document.getElementById('counselResults').style.display = 'none';
            document.getElementById('counselCombined').style.display = 'none';
            document.getElementById('askModelsBtn').disabled = true;

            const startTime = Date.now();

            try {
                const response = await fetch('/api/model-counsel', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ question, models: selectedModels })
                });

                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error || 'API request failed');
                }

                const totalTime = ((Date.now() - startTime) / 1000).toFixed(1);
                document.getElementById('responseTime').textContent = `Completed in ${totalTime}s`;

                // Render responses
                renderModelResponses(data.responses);
                
                // Generate combined answer if multiple responses
                const successfulResponses = data.responses.filter(r => r.content && !r.error);
                if (successfulResponses.length > 1) {
                    generateCombinedAnswer(question, successfulResponses);
                }

                document.getElementById('counselResults').style.display = 'block';
                showToast('Models Consulted', `Received ${successfulResponses.length} responses.`, 'accent');

            } catch (error) {
                console.error('Model Counsel error:', error);
                showToast('Error', error.message, 'danger');
            } finally {
                document.getElementById('counselLoading').style.display = 'none';
                document.getElementById('askModelsBtn').disabled = false;
            }
        }

        function renderModelResponses(responses) {
            const grid = document.getElementById('modelResponsesGrid');
            
            grid.innerHTML = responses.map(r => `
                <div class="model-response-card">
                    <div class="model-response-header">
                        <div class="model-response-name" style="--model-color: ${r.color};">
                            <span class="model-dot" style="--model-color: ${r.color};"></span>
                            ${r.name}
                        </div>
                        <div class="model-response-meta">
                            ${r.tokens ? `<span>${r.tokens.input + r.tokens.output} tokens</span>` : ''}
                            ${r.latencyMs ? `<span>${(r.latencyMs / 1000).toFixed(1)}s</span>` : ''}
                        </div>
                    </div>
                    ${r.error 
                        ? `<div class="model-response-error">Error: ${r.error}</div>`
                        : `<div class="model-response-content">${formatResponse(r.content)}</div>`
                    }
                </div>
            `).join('');
        }

        function formatResponse(content) {
            if (!content) return '';
            // Basic markdown-like formatting
            return content
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`(.*?)`/g, '<code>$1</code>');
        }

        async function generateCombinedAnswer(question, responses) {
            // Use the first successful model to generate a synthesis
            const synthesis = `Based on ${responses.length} model responses, here are the key insights:\n\n` +
                responses.map((r, i) => `• ${r.name}: ${r.content.substring(0, 200)}...`).join('\n\n');
            
            document.getElementById('combinedContent').innerHTML = `
                <p style="color: var(--text-secondary); margin-bottom: var(--space-4);">
                    Synthesis of ${responses.length} model responses:
                </p>
                <div style="display: grid; gap: var(--space-3);">
                    ${responses.map(r => `
                        <div style="padding: var(--space-3); background: var(--bg-elevated); border-radius: var(--radius-sm); border-left: 3px solid ${r.color};">
                            <strong style="color: ${r.color};">${r.name}</strong>
                            <p style="margin-top: var(--space-2); font-size: 13px;">${r.content.substring(0, 300)}${r.content.length > 300 ? '...' : ''}</p>
                        </div>
                    `).join('')}
                </div>
            `;
            document.getElementById('counselCombined').style.display = 'block';
        }

        // Keyboard shortcut for Model Counsel (M key)
        document.addEventListener('keydown', (e) => {
            if (e.key === 'm' && !e.ctrlKey && !e.metaKey && !e.altKey && 
                document.activeElement.tagName !== 'INPUT' && 
                document.activeElement.tagName !== 'TEXTAREA') {
                navigateTo('model-counsel');
            }
        });
    </script>
</body>
</html>
